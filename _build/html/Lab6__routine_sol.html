

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lab 6 - Frequencies and Fourier series (routine) &#8212; Mathematical Methods for Biology</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-dropdown.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Mathematical Methods for Biology</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="discrete_1var_intro.html">
   1. Models with one variable in discrete time
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="discrete_nonlinear_intro.html">
   2. Nonlinear discrete-time dynamic models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ode_1var_intro.html">
   3. Models with one variable in continuous time
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="graph_ode_intro.html">
   4. Graphical analysis of ordinary differential equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="discrete_higher_intro.html">
   5. Discrete models of higher order
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_pp_intro.html">
   6. Linear ODEs with two variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="forces_pot_intro.html">
   7. Forces and potentials in biological modeling
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Lab6__routine_sol.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/Lab6__routine_sol.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/executablebooks/jupyter-book/blob/master/Lab6__routine_sol.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solution">
   Solution
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#assignment-overview">
   Assignment Overview:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-2-discrete-fft-and-signal-analysis">
   Part 2: Discrete FFT and signal analysis
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rubric">
   Rubric:
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="lab-6-frequencies-and-fourier-series-routine">
<h1>Lab 6 - Frequencies and Fourier series (routine)<a class="headerlink" href="#lab-6-frequencies-and-fourier-series-routine" title="Permalink to this headline">¶</a></h1>
<div class="section" id="solution">
<h2>Solution<a class="headerlink" href="#solution" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Necessary imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1">#package for work with arrays and matrices</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1">#package with plotting capabilities</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">f033c6b662af</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1">#package for work with arrays and matrices</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1">#package with plotting capabilities</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;scipy&#39;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="assignment-overview">
<h2>Assignment Overview:<a class="headerlink" href="#assignment-overview" title="Permalink to this headline">¶</a></h2>
<p>In this lab we will use the Fast Fourier Transform to performwhat is called <em>spectral analysis</em> (just a little late for Halloween). In short, spectral analysis is concerned with decomposing a time series by expanding it in terms o the basis set of sines and cosinesm, which means transforming the time series (often called a signal) from the time domain into the frequency domain. Once in the frequency domain, we can then see what  frequencies make up the signal. Our ability to do this comes from Fourier series and the fact that any signal can be represented by an infinite sum of sines and cosines (or complex exponentials), which you’ve seen in class. However, we cannot compute infinite series, so most real world analysis turns to the <em>discrete Fourier transform</em>.</p>
<p>In this lab, you will learn about numpy’s FFT function, how to use it to make power spectral density plots, and then investigate some data.</p>
<p><strong>Part 1: Coupled oscillators</strong></p>
<p>As we saw, the following system of second-order ODEs represets two coupled oscillators, with x and y representing the displacements of two unit masses tethered to an immovable object with spring constant k and coupled together with a spring with constant kc.</p>
<div class="math notranslate nohighlight">
\[\begin{split}   d^2x/dt^2 = -kx-kc(x-y) \\
d^2y/dt^2 = -ky-kc(y-x)\end{split}\]</div>
<p>Covert these two second order ODEs into 4 first-order ODEs by adding two new variables for velocities and modify the code from last week’s assignment for solving harmonic oscillator ODEs to reflect this change. <strong>Hint: Pay attention to the order of the variables returned by the function used in the ODE solver (that was called fun in the sample code) - they should match the order of the equations in the system of ODEs.</strong></p>
<p><strong>Q1.1:</strong> Set k=0 and kc=2 and calculate the eigenvalues and eigenvectors (normal modes) of the matrix for the two second-order ODEs. Based on this, predict the frequencies of the oscillation of the normal modes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the eigenvalues of the Hessian matrix:</span>
<span class="n">k</span> <span class="o">=</span><span class="mi">0</span>
<span class="n">kc</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">Matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[(</span><span class="o">-</span><span class="n">k</span><span class="o">-</span><span class="n">kc</span><span class="p">),</span> <span class="n">kc</span><span class="p">],[</span><span class="n">kc</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">-</span><span class="n">kc</span><span class="p">)]</span> <span class="p">])</span>
<span class="n">evals</span><span class="p">,</span> <span class="n">evecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">Matrix</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">evals</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">evecs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 4.4408921e-16 -4.0000000e+00]
[[ 0.70710678 -0.70710678]
 [ 0.70710678  0.70710678]]
</pre></div>
</div>
</div>
</div>
<p>The eigenvalues are 0 and -4, corresponding to a no oscillation (rigid-body) mode with equal displacements of the two massess and two a mode with frequency 2 with equal and opposite displacements.</p>
<p><strong>Q1.2:</strong> Set some initial values, solve the ODEs and plot the solutions of the displacements of the two masses over time. Describe the dynamics and note how many frequencies are visible in the plots. Choose initial values for positions that correspond to the first normal mode while keeping both velocity variables at 0 and solve the ODE.
Explain your result in terms of the eigenvalue of the first normal mode. Choose the initial values for positions that correspond to the second normal mode, keeping the velocity variables at 0 and solve the ODE. Explain your result in terms of the eigenvalue of the second normal mode.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">kc</span><span class="p">):</span>
    <span class="n">newxy</span> <span class="o">=</span> <span class="p">[</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">-</span><span class="n">kc</span><span class="p">)</span><span class="o">*</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">kc</span><span class="o">*</span><span class="n">xy</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">xy</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">-</span><span class="n">kc</span><span class="p">)</span><span class="o">*</span><span class="n">xy</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">kc</span><span class="o">*</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">newxy</span>

<span class="c1">#Set the parameter values</span>
<span class="n">k</span> <span class="o">=</span><span class="mi">0</span>
<span class="n">kc</span> <span class="o">=</span> <span class="mi">2</span>


<span class="c1"># Set up arrays of initial values</span>
<span class="n">Xinit</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]</span>
<span class="n">Vinit</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">Yinit</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.4</span><span class="p">]</span>
<span class="n">Winit</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>


<span class="c1"># Set time vector</span>
<span class="n">Tmax</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">numsteps</span> <span class="o">=</span> <span class="n">Tmax</span><span class="o">/</span><span class="n">dt</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Tmax</span><span class="p">,</span> <span class="n">numsteps</span><span class="p">)</span> <span class="c1"># create time vector</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Xinit</span><span class="p">)):</span>
    <span class="c1"># Set different initial values, the vector of times, and call the ODE solver again</span>
    <span class="n">init</span> <span class="o">=</span> <span class="p">[</span><span class="n">Xinit</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">Vinit</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">Yinit</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">Winit</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="c1">#[intial x, initial y]</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">init</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">kc</span><span class="p">))</span> <span class="c1"># calculate numeric solution of ODE defined in fun</span>

    <span class="c1"># Plot the solution... </span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sol</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;x0=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">init</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, y0=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">init</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sol</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;x0=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">init</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, y0=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">init</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>

    
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;displacement of x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Solution for harmonic oscillator with k=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39; and kc=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kc</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;displacement of y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Solution for harmonic oscillator with k=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39; and kc=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kc</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/dkon/anaconda3/lib/python3.6/site-packages/ipykernel_launcher.py:21: DeprecationWarning: object of type &lt;class &#39;float&#39;&gt; cannot be safely interpreted as an integer.
</pre></div>
</div>
<img alt="_images/Lab6__routine_sol_8_1.png" src="_images/Lab6__routine_sol_8_1.png" />
<img alt="_images/Lab6__routine_sol_8_2.png" src="_images/Lab6__routine_sol_8_2.png" />
</div>
</div>
<p>If one diplaces the masses only along the zero-frequency mode, the position with remain static, and if one displaces them along the oscillatory mode only, the will oscillate around. If the initial displacements are a combination, there will be oscillation a nonzero displacement of the two masses, always with the same frequency.</p>
<p><strong>Q1.3:</strong> Set <span class="math notranslate nohighlight">\(k=9\)</span> and <span class="math notranslate nohighlight">\(kc=2\)</span> and calculate the eigenvalues and eigenvectors of the matrix for the two second-order ODEs. Based on this, predict the frequencies of the oscillation of the normal modes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the eigenvalues of the Hessian matrix:</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">kc</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">Matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[(</span><span class="o">-</span><span class="n">k</span><span class="o">-</span><span class="n">kc</span><span class="p">),</span> <span class="n">kc</span><span class="p">],[</span><span class="n">kc</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">-</span><span class="n">kc</span><span class="p">)]</span> <span class="p">])</span>
<span class="n">evals</span><span class="p">,</span> <span class="n">evecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">Matrix</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">evals</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">evecs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ -9. -13.]
[[ 0.70710678 -0.70710678]
 [ 0.70710678  0.70710678]]
</pre></div>
</div>
</div>
</div>
<p>The eigenvalues are -9 and -13, corresponding to a  mode with frequncy sqrt(5) with equal displacements of the two massess and two a mode with frequency 3 with equal and opposite displacements.</p>
<p><strong>Q1.4:</strong> Set some initial values, solve the ODEs and plot the solutions of the displacements of the two masses over time. Describe the dynamics and note how many frequencies are visible in the plots. Choose initial values for positions that correspond to the first normal mode while keeping both velocity variables at 0 and solve the ODE. Explain your result in terms of the eigenvalue of the first normal mode. Choose the initial values for positions that correspond to the second normal mode, keeping the velocity variables at 0 and solve the ODE.  Explain your result in terms of the eigenvalue of the second normal mode.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the parameter values </span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">kc</span> <span class="o">=</span> <span class="mi">2</span>


<span class="c1"># Set up arrays of initial values</span>
<span class="n">Xinit</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]</span>
<span class="n">Vinit</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">Yinit</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.4</span><span class="p">]</span>
<span class="n">Winit</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1"># Set time vector</span>
<span class="n">Tmax</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">numsteps</span> <span class="o">=</span> <span class="n">Tmax</span><span class="o">/</span><span class="n">dt</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Tmax</span><span class="p">,</span> <span class="n">numsteps</span><span class="p">)</span> <span class="c1"># create time vector</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Xinit</span><span class="p">)):</span>
    <span class="c1"># Set different initial values, the vector of times, and call the ODE solver again</span>
    <span class="n">init</span> <span class="o">=</span> <span class="p">[</span><span class="n">Xinit</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">Vinit</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">Yinit</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">Winit</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="c1">#[intial x, initial y]</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">init</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">kc</span><span class="p">))</span> <span class="c1"># calculate numeric solution of ODE defined in fun</span>

    <span class="c1"># Plot the solution... </span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sol</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;x0=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">init</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, y0=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">init</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sol</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;x0=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">init</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, y0=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">init</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>

    
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;displacement of x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Solution for harmonic oscillator with k=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39; and kc=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kc</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;displacement of y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Solution for harmonic oscillator with k=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39; and kc=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kc</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/dkon/anaconda3/lib/python3.6/site-packages/ipykernel_launcher.py:16: DeprecationWarning: object of type &lt;class &#39;float&#39;&gt; cannot be safely interpreted as an integer.
  app.launch_new_instance()
</pre></div>
</div>
<img alt="_images/Lab6__routine_sol_14_1.png" src="_images/Lab6__routine_sol_14_1.png" />
<img alt="_images/Lab6__routine_sol_14_2.png" src="_images/Lab6__routine_sol_14_2.png" />
</div>
</div>
<p>If the initial displacements are exactly along one of the modes, the solutions will oscillate with the corresponding frequency only. Otherwise, the waves are a combination of two frequencies.</p>
</div>
<div class="section" id="part-2-discrete-fft-and-signal-analysis">
<h2>Part 2: Discrete FFT and signal analysis<a class="headerlink" href="#part-2-discrete-fft-and-signal-analysis" title="Permalink to this headline">¶</a></h2>
<p>The IEEE has called the Fast Fourier Transform (FFT) one of the most important algorithms developed in the 20th century. It is important to note that the FFT is an algorithm that we use to perform a discreteFourier transform (DFT), although they are sometimes used interchangeably.</p>
<p>The script below generates a data set composed of a sum of two periodic signals with different frequencies, ff1 and ff2 and corresponding weight w1 and w2. The fake signal is then generated with a certain sampling rate Fs, which defines the time array on which the “data” were collected. The sampling rate specifies the upper bound of the frequency that can be detected, which is called the Nyquist-Shannon frequency and is equal to half of the sampling frequency.</p>
<p>The script runs the fft function on the signal and returns an array of complex Fourier coeffients, from which we then computed the <em>power spectrum</em> of the signal, which is the absolute value of the square coefficients. The power spectrum is plotted against the frequency vector, showing the composition of the signal in terms of different frequencies. The peaks show the frequencies that we put into our generated fake signal, are you are invited to try varying the frequencies and their weights and to see what happens, especially when a frequency is set above the Nyquist-Shannon threshold.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Fs</span> <span class="o">=</span> <span class="mf">150.0</span>  <span class="c1"># sampling rate</span>
<span class="n">Ts</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">Fs</span> <span class="c1"># sampling interval</span>
<span class="n">Max_time</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="c1"># duration of the signal</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Max_time</span><span class="p">,</span><span class="n">Ts</span><span class="p">)</span> <span class="c1"># time vector</span>

<span class="c1"># generate a signal with different frequencies</span>
<span class="n">ff1</span> <span class="o">=</span> <span class="mi">5</span>   <span class="c1"># frequency 1 of the signal</span>
<span class="n">ff2</span> <span class="o">=</span> <span class="mi">25</span>   <span class="c1"># frequency 2 of the signal</span>
<span class="n">w1</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># weight of frequency 1</span>
<span class="n">w2</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># weight of frequency 2</span>
<span class="n">fake_signal</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">ff1</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">+</span> <span class="n">w2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">ff2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># frequency stuff</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fake_signal</span><span class="p">)</span> <span class="c1"># length of the signal</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="c1"># all the frequency indices</span>
<span class="n">frq</span> <span class="o">=</span> <span class="n">k</span><span class="o">/</span><span class="n">Max_time</span>  <span class="c1"># two sides frequency range</span>
<span class="n">num_freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span> <span class="c1"># number of frequencies</span>
<span class="n">frq</span> <span class="o">=</span> <span class="n">frq</span><span class="p">[</span><span class="n">num_freq</span><span class="p">]</span> <span class="c1"># non-redundant frequency range</span>

<span class="c1"># FFT and power spectrum calculations</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">fake_signal</span><span class="p">)</span><span class="o">/</span><span class="n">n</span> <span class="c1"># fft computing and normalization</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">num_freq</span><span class="p">]</span>
<span class="n">ps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="c1"># power spectrum</span>

<span class="c1"># plotting the signal and the power spectrum</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">fake_signal</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">frq</span><span class="p">,</span><span class="n">ps</span><span class="p">[</span><span class="n">num_freq</span><span class="p">],</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="c1"># plotting the power spectrum</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Freq (Hz)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;|Y(freq)^2|&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Lab6__routine_sol_17_0.png" src="_images/Lab6__routine_sol_17_0.png" />
</div>
</div>
<p><strong>Q2.1:</strong> Run your code from part 1 of this assignmentfor untethered oscillators (k=0 and kc=100) for the duration of 10 time units and save the position data for the first mass (since they are symmetric, the second mass will look the same). Try different initial values, in particular ones that correspond to the normal modes (with zero initial velocities). Again, determine the sampling frequency of the data set and plot the power frequency spectrum. Report the peak frequencies you observe in the power spectrum, and comment on their correspondence to your frequency analysis from part 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Set the parameter values</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">kc</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Set time vector</span>
<span class="n">Tmax</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">numsteps</span> <span class="o">=</span> <span class="n">Tmax</span><span class="o">/</span><span class="n">dt</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Tmax</span><span class="p">,</span> <span class="n">numsteps</span><span class="p">)</span> <span class="c1"># create time vector</span>

<span class="n">init</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="c1"># initial values</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">init</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">kc</span><span class="p">))</span> <span class="c1"># calculate numeric solution of ODE defined in fun</span>


<span class="n">Fs</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dt</span> <span class="c1"># sampling rate  </span>

<span class="n">fake_signal</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># frequency stuff</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fake_signal</span><span class="p">)</span> <span class="c1"># length of the signal</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="c1"># all the frequency indices</span>
<span class="n">frq</span> <span class="o">=</span> <span class="n">k</span><span class="o">/</span><span class="n">Tmax</span> <span class="c1"># two sides frequency range</span>
<span class="n">num_freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span> <span class="c1"># number of frequencies</span>
<span class="n">frq</span> <span class="o">=</span> <span class="n">frq</span><span class="p">[</span><span class="n">num_freq</span><span class="p">]</span> <span class="c1"># non-redundant frequency range</span>

<span class="c1"># FFT and power spectrum calculations</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">fake_signal</span><span class="p">)</span><span class="o">/</span><span class="n">n</span> <span class="c1"># fft computing and normalization</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">num_freq</span><span class="p">]</span>
<span class="n">ps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="c1"># power spectrum</span>

<span class="c1"># plotting the signal and the power spectrum</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">fake_signal</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">frq</span><span class="p">,</span><span class="n">ps</span><span class="p">[</span><span class="n">num_freq</span><span class="p">],</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="c1"># plotting the power spectrum</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Freq (Hz)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;|Y(freq)^2|&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/dkon/anaconda3/lib/python3.6/site-packages/ipykernel_launcher.py:9: DeprecationWarning: object of type &lt;class &#39;float&#39;&gt; cannot be safely interpreted as an integer.
  if __name__ == &#39;__main__&#39;:
</pre></div>
</div>
<img alt="_images/Lab6__routine_sol_19_1.png" src="_images/Lab6__routine_sol_19_1.png" />
</div>
</div>
<p>Playing around with the parameters and initial values should indicate either pure oscillations or oscillations with a translation, in which case there will be a large zero-frequency term.</p>
<p><strong>Q2.2:</strong> Run your code from part 1 of this assignment for tethered oscillators (k=25 and kc=100) for the duration of 10 time units and save the position data for the first mass (since they are symmetric, the second mass will look the same). Determine the sampling frequency of the data set and plot the power frequency spectrum. Report the peak frequencies you observe in the power spectrum, and comment on their correspondence to your frequency analysis from part 1.  a</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Set the parameter values</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">kc</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Set time vector</span>
<span class="n">Tmax</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">numsteps</span> <span class="o">=</span> <span class="n">Tmax</span><span class="o">/</span><span class="n">dt</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Tmax</span><span class="p">,</span> <span class="n">numsteps</span><span class="p">)</span> <span class="c1"># create time vector</span>

<span class="n">init</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="c1"># initial values</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">init</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">kc</span><span class="p">))</span> <span class="c1"># calculate numeric solution of ODE defined in fun</span>


<span class="n">Fs</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dt</span> <span class="c1"># sampling rate  </span>

<span class="n">fake_signal</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># frequency stuff</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fake_signal</span><span class="p">)</span> <span class="c1"># length of the signal</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="c1"># all the frequency indices</span>
<span class="n">frq</span> <span class="o">=</span> <span class="n">k</span><span class="o">/</span><span class="n">Tmax</span> <span class="c1"># two sides frequency range</span>
<span class="n">num_freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span> <span class="c1"># number of frequencies</span>
<span class="n">frq</span> <span class="o">=</span> <span class="n">frq</span><span class="p">[</span><span class="n">num_freq</span><span class="p">]</span> <span class="c1"># non-redundant frequency range</span>

<span class="c1"># FFT and power spectrum calculations</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">fake_signal</span><span class="p">)</span><span class="o">/</span><span class="n">n</span> <span class="c1"># fft computing and normalization</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">num_freq</span><span class="p">]</span>
<span class="n">ps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="c1"># power spectrum</span>

<span class="c1"># plotting the signal and the power spectrum</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">fake_signal</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">frq</span><span class="p">,</span><span class="n">ps</span><span class="p">[</span><span class="n">num_freq</span><span class="p">],</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="c1"># plotting the power spectrum</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Freq (Hz)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;|Y(freq)^2|&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/dkon/anaconda3/lib/python3.6/site-packages/ipykernel_launcher.py:9: DeprecationWarning: object of type &lt;class &#39;float&#39;&gt; cannot be safely interpreted as an integer.
  if __name__ == &#39;__main__&#39;:
</pre></div>
</div>
<img alt="_images/Lab6__routine_sol_22_1.png" src="_images/Lab6__routine_sol_22_1.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3558812717085886
</pre></div>
</div>
</div>
</div>
<p>Two different frequency peaks should be observed, corresponding to the two eigenvalues of the Hessian matrix.</p>
</div>
<div class="section" id="rubric">
<h2>Rubric:<a class="headerlink" href="#rubric" title="Permalink to this headline">¶</a></h2>
<p><strong>Part 1:</strong>
2 pts for questions 1 and 3
5 pts for questions 2 and 4</p>
<p><strong>Part 2:</strong>
5 pts per question</p>
<p><strong>Total: 24 pts</strong></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Dmitry Kondrashov<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>