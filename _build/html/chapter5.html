

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Graphical analysis of ordinary differential equations &#8212; Mathematical Methods for Biology</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-dropdown.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Mathematical Methods for Biology</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="chapter1_intro.html">
   1. Models with one variable in discrete time
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter2_intro.html">
   2. Nonlinear discrete-time dynamic models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter3_intro.html">
   3. Discrete models of higher order: age-structured population models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter4_intro.html">
   4. Models with one variable in continuous time
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/chapter5.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#building-nonlinear-odes">
   Building nonlinear ODEs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#qualitative-analysis-of-odes">
   Qualitative analysis of ODEs
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#graphical-analysis-of-the-defining-function">
     graphical analysis of the defining function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fixed-points-and-stability">
     fixed points and stability
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#outline-of-qualitative-analysis-of-an-ode">
     Outline of qualitative analysis of an ODE
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modeling-the-spread-of-infectious-disease">
   Modeling the spread of infectious disease
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="graphical-analysis-of-ordinary-differential-equations">
<h1>Graphical analysis of ordinary differential equations<a class="headerlink" href="#graphical-analysis-of-ordinary-differential-equations" title="Permalink to this headline">Â¶</a></h1>
<p>We now proceed from  linear ODEs to more complicated nonlinear equations. In contrast to linear differential equations, which can be solved in general, nonlinear differential equations may not be solvable even theoretically. Even though the solutions cannot be written down, they exist and can exhibit much more interesting behaviors than the exponential solutions we have seen. When solutions cannot be found on paper, we have two options: 1) use qualitative or graphical tools, such as finding equilibrium points and their stability, to predict the long-term dynamics of the solution; 2) construct numerical solutions that approximate the true solution. In this chapter we concentrate on the qualitative approach to analyzing ODEs, which allows one to predict the behavior of solutions of any autonomous ODE based on the graph of the defining function of the equation. After working through this chapter you will learn to do the following:</p>
<ul class="simple">
<li><p>find equilibrium values of an ODE</p></li>
<li><p>analyze the stability of equilibria based on the graph of the defining function</p></li>
<li><p>write down stability conditions analytically</p></li>
<li><p>use graphical techniques to predict the behavior of the solution of a difference equation without solving it</p></li>
<li><p>understand basic compartment epidemiology models</p></li>
</ul>
<div class="section" id="building-nonlinear-odes">
<h2>Building nonlinear ODEs<a class="headerlink" href="#building-nonlinear-odes" title="Permalink to this headline">Â¶</a></h2>
<p>The simple, linear population growth models we have seen in the last two chapters assume that the per capita birth and death rates are constant, that is, they stay the same regardless of population size. The solutions for these models either grow or decay exponentially, but in reality, populations do not grow without bounds. It is generally true that the larger a population grows, the more scarce the resources, and survival becomes more difficult. For larger populations, this could lead to higher death rates, or lower birth rates, or both.</p>
<p>How can we incorporate this effect into a quantitative model? We will assume there are separate birth and death rates, and that the birth rate declines as the population grows, while the death rate increases. Suppose there are inherent birth rates <span class="math notranslate nohighlight">\(b\)</span> and <span class="math notranslate nohighlight">\(d\)</span>, and the overall birth and death rates <span class="math notranslate nohighlight">\(B\)</span> and <span class="math notranslate nohighlight">\(D\)</span>  depend linearly on population size <span class="math notranslate nohighlight">\(P\)</span>: <span class="math notranslate nohighlight">\(B  =  b - aP\)</span> and <span class="math notranslate nohighlight">\(D  =  d + cP\)</span>.</p>
<p>To model the rate of change of the population, we need to multiply the rates <span class="math notranslate nohighlight">\(B\)</span> and <span class="math notranslate nohighlight">\(D\)</span> by the population size <span class="math notranslate nohighlight">\(P\)</span>, since each individual can reproduce or die. Also, since the death rate <span class="math notranslate nohighlight">\(D\)</span> decreases the population, we need to put a negative sign on it. The resulting model is:</p>
<div class="math notranslate nohighlight" id="equation-logistic-ode">
<span class="eqno">()<a class="headerlink" href="#equation-logistic-ode" title="Permalink to this equation">Â¶</a></span>\[ 
\dot P = BP - DP = [(b-d)-(a+c)P]P 
\]</div>
<p>The parameters of the model, the constants <span class="math notranslate nohighlight">\(a,b,c,d\)</span>, have different meanings. Performing \index{dimensional analysis} dimensional analysis, we find that <span class="math notranslate nohighlight">\(b\)</span> and <span class="math notranslate nohighlight">\(d\)</span> have the dimensions of <span class="math notranslate nohighlight">\(1/[t]\)</span>, the same as the rate <span class="math notranslate nohighlight">\(r\)</span> in the exponential growth model. However, the dimensions of <span class="math notranslate nohighlight">\(a\)</span> (and <span class="math notranslate nohighlight">\(c\)</span>) must obey the relation: <span class="math notranslate nohighlight">\([P]/[t] = [a][P]^2\)</span>, and thus,</p>
<div class="math notranslate nohighlight">
\[
[a]=[c] = \frac{1}{[t][P]}
\]</div>
<p>This shows that the constants <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(c\)</span> have to be treated differently than <span class="math notranslate nohighlight">\(b\)</span> and <span class="math notranslate nohighlight">\(d\)</span>. Let us define the inherent growth rate of the population, to be <span class="math notranslate nohighlight">\(r_0=b-d\)</span> (if the death rate is greater than the birth rate, the population will inherently decline). Then let us introduce another constant <span class="math notranslate nohighlight">\(K\)</span>, such that <span class="math notranslate nohighlight">\((a+c)=r_0/K\)</span>. It should be clear from the dimensional analysis that <span class="math notranslate nohighlight">\(K\)</span> has units of <span class="math notranslate nohighlight">\(P\)</span>, population size. Now we can write down the logistic equation in the canonical form:</p>
<div class="math notranslate nohighlight" id="equation-log-ode-model">
<span class="eqno">()<a class="headerlink" href="#equation-log-ode-model" title="Permalink to this equation">Â¶</a></span>\[
\dot P = r\left(1-\frac{P}{K}\right)P
\]</div>
<p>This model can be re-written as  <span class="math notranslate nohighlight">\(\dot P = aP -bP^2\)</span>, so it is clear that there is a <em>linear term</em> (<span class="math notranslate nohighlight">\(aP\)</span>) and a <em>nonlinear term</em> (<span class="math notranslate nohighlight">\(-bP^2\)</span>). When <span class="math notranslate nohighlight">\(P\)</span> is sufficiently small(and positive) the linear term is greater, and the population grows. When <span class="math notranslate nohighlight">\(P\)</span> is large enough, the nonlinear term wins and the population declines.</p>
<p>It should be apparent that there are two fixed points, at <span class="math notranslate nohighlight">\(P=0\)</span> and at <span class="math notranslate nohighlight">\(P=K\)</span>. The first one corresponds to a population with no individuals. On the other hand, <span class="math notranslate nohighlight">\(K\)</span> signifies the population at which the negative effect of population size balances out the inherent population growth rate, and is called the <em>carrying capacity</em> of a population in its environment \citep{otto_biologists_2007}. We will analyze the qualitative behavior of the solution, without writing it down, in the next section of this chapter.</p>
</div>
<div class="section" id="qualitative-analysis-of-odes">
<h2>Qualitative analysis of ODEs<a class="headerlink" href="#qualitative-analysis-of-odes" title="Permalink to this headline">Â¶</a></h2>
<p>In this section we will analyze the behavior of solutions of an autonomous ODE without solving it on paper. Generally, ODE models for realistic biological systems are nonlinear, and most nonlinear differential equations cannot be solved analytically. We can make predictions about the behavior, or <em>dynamics</em> of solutions by considering the properties of the \index{differential equation!defining function} <em>defining function</em>, which is the function on the right-hand-side of a general autonomous ODE:</p>
<div class="math notranslate nohighlight" id="equation-gen-aut-ode">
<span class="eqno">()<a class="headerlink" href="#equation-gen-aut-ode" title="Permalink to this equation">Â¶</a></span>\[ 
\frac{dx}{dt} = f(x)
\]</div>
<div class="section" id="graphical-analysis-of-the-defining-function">
<h3>graphical analysis of the defining function<a class="headerlink" href="#graphical-analysis-of-the-defining-function" title="Permalink to this headline">Â¶</a></h3>
<p>The defining function relates the value of the solution variable <span class="math notranslate nohighlight">\(x\)</span> to its rate of change <span class="math notranslate nohighlight">\(dx/dt\)</span>. For different values of <span class="math notranslate nohighlight">\(x\)</span>, the rate of change of <span class="math notranslate nohighlight">\(x(t)\)</span> is different, and it is defined by the function <span class="math notranslate nohighlight">\(f(x)\)</span>. There are only three options:</p>
<ul class="simple">
<li><p>if <span class="math notranslate nohighlight">\(f(x) &gt; 0\)</span>, <span class="math notranslate nohighlight">\(x(t)\)</span> is increasing at that value of <span class="math notranslate nohighlight">\(x\)</span></p></li>
<li><p>if <span class="math notranslate nohighlight">\(f(x) &lt; 0\)</span>, <span class="math notranslate nohighlight">\(x(t)\)</span> is decreasing at that value of <span class="math notranslate nohighlight">\(x\)</span></p></li>
<li><p>if <span class="math notranslate nohighlight">\(f(x) = 0\)</span>, <span class="math notranslate nohighlight">\(x(t)\)</span> is not changing that value of <span class="math notranslate nohighlight">\(x\)</span></p></li>
</ul>
<p>To determine for which values of <span class="math notranslate nohighlight">\(x\)</span> the solution <span class="math notranslate nohighlight">\(x(t)\)</span> increases and decreases, it enough to look at the plot of <span class="math notranslate nohighlight">\(f(x)\)</span>. On the intervals where the graph of <span class="math notranslate nohighlight">\(f(x)\)</span> is above the <span class="math notranslate nohighlight">\(x\)</span>-axis <span class="math notranslate nohighlight">\(x(t)\)</span> increases, on the intervals where  the graph of <span class="math notranslate nohighlight">\(f(x)\)</span> is below the <span class="math notranslate nohighlight">\(x\)</span>-axis, <span class="math notranslate nohighlight">\(x(t)\)</span> decreases. The roots (zeros) of <span class="math notranslate nohighlight">\(f(x)\)</span> are special cases, they separate the range of <span class="math notranslate nohighlight">\(x\)</span> into the intervals where the solution grows and and where it decreases. This seems exceedingly simple, and it is, but it provides specific information about <span class="math notranslate nohighlight">\(x(t)\)</span>, without knowing how to write down its formula.</p>
<p>For an autonomous ODE with one dependent variable, the direction of the rate of change prescribed by the differential equation can be graphically represented by sketching the \index{differential equation!flow} <em>flow on the line</em> of the dependent variable. The flow stands for the direction of change at every point, specifically increasing, decreasing, or not changing. The flow is  plotted on the horizontal x-axis, so if <span class="math notranslate nohighlight">\(x\)</span> is increasing, the flow will be indicated by a rightward arrow, and if it is decreasing, the flow will point to the left. The fixed points separate the regions of increasing (rightward) flow and decreasing (leftward) flow.</p>
<p><strong>Example.</strong> Consider a linear ODE the likes of which we have solved in section \ref{sec:math15}:</p>
<div class="math notranslate nohighlight">
\[
\frac{dx}{dt} = 4x -100
\]</div>
<p>The defining function is a straight line vs. <span class="math notranslate nohighlight">\(x\)</span>, its graph is shown in figure \ref{fig:ch16_flow_linear}a. Based on this graph, we conclude that the solution decreases when <span class="math notranslate nohighlight">\(x&lt;25\)</span> and increases when <span class="math notranslate nohighlight">\(x&gt;25\)</span>. Thus we can sketch the solution <span class="math notranslate nohighlight">\(x(t)\)</span> over time, without knowing its functional form. The dynamics depends on the initial value: if <span class="math notranslate nohighlight">\(x(0)&lt;25\)</span>, the solution will keep decreasing without bound, and go off to negative infinity; if <span class="math notranslate nohighlight">\(x(0)&gt;25\)</span>, the solution will keep decreasing without bound, and go off to positive infinity. This is shown by plotting numerical solutions of this ODE for several initial values in figure \ref{fig:ch16_flow_linear}b. The dotted line shows the location of the special value of 25 which separates the interval of growth from the interval of decline.</p>
<p><strong>Example.</strong> Now let us analyze a nonlinear ODE, specifically the logistic model with the following parameters:</p>
<div class="math notranslate nohighlight">
\[
\frac{dP}{dt} =0.3P\left(1-\frac{P}{40}\right)
\]</div>
<p>The defining function is a downward-facing parabola with two roots at <span class="math notranslate nohighlight">\(P=0\)</span> and <span class="math notranslate nohighlight">\(P=40\)</span>, as shown in figure \ref{fig:ch16_flow_logistic}a. Between the two roots, the defining function is positive, which means the derivative <span class="math notranslate nohighlight">\(dP/dt\)</span> is positive too, so the solution grows on that interval. For <span class="math notranslate nohighlight">\(P&lt;0\)</span> and <span class="math notranslate nohighlight">\(P&gt;40\)</span>, the solution decreases. Therefore, we can sketch the graphs of the solution <span class="math notranslate nohighlight">\(P(t)\)</span> starting with different initial conditions, as show in figure \ref{fig:ch16_flow_logistic}b.</p>
<p>To summarize, the defining function of the ODE determines the rate of change of the solution <span class="math notranslate nohighlight">\(x(t)\)</span> depending on the value of <span class="math notranslate nohighlight">\(x\)</span>. The graphical approach to finding areas of right and left flow is based on graphing the function <span class="math notranslate nohighlight">\(f(x)\)</span>, and dividing the x-axis based on the sign of <span class="math notranslate nohighlight">\(f(x)\)</span>. In the areas where <span class="math notranslate nohighlight">\(f(x) &gt; 0\)</span>, its graph is above the x-axis, and the flow is to the right; conversely, when <span class="math notranslate nohighlight">\(f(x) &lt; 0\)</span>, its graph is below the x-axis, and the flow is to the left. The next subsection puts this approach in a more analytic framework.</p>
</div>
<div class="section" id="fixed-points-and-stability">
<h3>fixed points and stability<a class="headerlink" href="#fixed-points-and-stability" title="Permalink to this headline">Â¶</a></h3>
<p>We have seen that the dynamics of solutions of differential equations depend on the initial value of the dependent variable: for some values the solution increases, for others it decreases, and for intermediate values it remains the same. Those special values separating intervals of increase and decrease are called fixed points (or equilibria), and the first step to understanding the dynamics of an ODE is finding its fixed points. A fixed point is a value of the solution at which the dynamical system stays constant, thus, the derivative of the solution must be zero. Here is  the formal definition:</p>
<div class="admonition-definition admonition">
<p class="admonition-title">Definition</p>
<p>For an ordinary differential equation <span class="math notranslate nohighlight">\(\dot x = f(x)\)</span>, a point <span class="math notranslate nohighlight">\(x^*\)</span> which satisfies <span class="math notranslate nohighlight">\(f(x^*)=0\)</span> is called a <em>fixed point</em> or <em>equilibrium</em>, and the solution with the initial condition <span class="math notranslate nohighlight">\(x(0)=x^*\)</span> is constant over time <span class="math notranslate nohighlight">\(x(t)=x^*\)</span>.</p>
</div>
<p><strong>Example.</strong> The linear equation <span class="math notranslate nohighlight">\(\dot x  = rx\)</span> has a single fixed point at <span class="math notranslate nohighlight">\(x^* = 0\)</span>. For a more interesting example, consider a logistic equation: <span class="math notranslate nohighlight">\(\dot x = x - x^2\)</span>. Its fixed points are the solutions of <span class="math notranslate nohighlight">\(x - x^2 = 0\)</span>, therefore there two fixed points: <span class="math notranslate nohighlight">\(x^* = 0, 1\)</span>. We know that if the solution has either of the fixed points as the initial condition, it will remain at that value for all time.</p>
<p>Locating the fixed points is not sufficient to predict the global behavior of the dynamical system, however. What happens to the solution of a dynamical system if the initial condition is very close to an equilibrium, but not precisely at it? Put another way, what happens if the equilibrium is perturbed? The solution may be attracted to the equilibrium value, that is, it approaches it ever-closer, or else it is not. In the first case, this is called a stable equilibrium, because a small perturbation does not dramatically change the long-term behavior of the solution. In the latter case, the equilibrium is called unstable, and the solution perturbed from the equilibrium never returns. These concepts are formalized in the following definition</p>
<div class="admonition-definition admonition">
<p class="admonition-title">Definition</p>
<p>A fixed point  <span class="math notranslate nohighlight">\(x^*\)</span> of an ODE <span class="math notranslate nohighlight">\(\dot x = f(x)\)</span> is called a <em>stable</em> fixed point (or sink) if for a sufficiently small number <span class="math notranslate nohighlight">\(\epsilon\)</span>, the solution <span class="math notranslate nohighlight">\(x(t)\)</span> with the initial condition <span class="math notranslate nohighlight">\(x_0 = x^* + \epsilon\)</span> approaches the fixed point <span class="math notranslate nohighlight">\(x^*\)</span> as <span class="math notranslate nohighlight">\(t \rightarrow \infty\)</span>. If the solution <span class="math notranslate nohighlight">\(x(t)\)</span> does not approach <span class="math notranslate nohighlight">\(x^*\)</span> for all nonzero <span class="math notranslate nohighlight">\(\epsilon\)</span>, the fixed point is called an <em>unstable</em> fixed point (or source).</p>
</div>
<p>To determine whether a fixed point is stable analytically we use the approach called \index{differential equation!linearization}\index{linearization!differential equation} <em>linearization</em>, which involves replacing the function <span class="math notranslate nohighlight">\(f(x)\)</span> with a linear approximation.  Let us define <span class="math notranslate nohighlight">\(\epsilon(t)\)</span> to be the deviation of the solution <span class="math notranslate nohighlight">\(x(t)\)</span> from the fixed point <span class="math notranslate nohighlight">\(x^*\)</span>, so we can write <span class="math notranslate nohighlight">\(x(t) = x^* + \epsilon(t)\)</span>. Assuming that <span class="math notranslate nohighlight">\(\epsilon(t)\)</span> is small, we can write the function <span class="math notranslate nohighlight">\(f(x)\)</span> using Taylorâs formula:</p>
<div class="math notranslate nohighlight">
\[
f(x^*+\epsilon(t))= f(x^*)+f'(x^*) \epsilon(t) + ... = f'(x^*) \epsilon(t) + ... 
\]</div>
<p>The term <span class="math notranslate nohighlight">\(f(x^*)\)</span> vanished because it is zero by definition \ref{def:ch16_fixedpt} of a fixed point. The ellipsis indicates all the terms of order <span class="math notranslate nohighlight">\(\epsilon(t)^2\)</span> and higher, which are very small if <span class="math notranslate nohighlight">\(\epsilon(t)\)</span> is small, and thus can be neglected. Thus, we can write the following approximation to the ODE <span class="math notranslate nohighlight">\(\dot x = f(x)\)</span> near a fixed point:</p>
<div class="math notranslate nohighlight">
\[
\dot x =  \frac{d(x^* + \epsilon(t))}{dt} = \dot \epsilon(t) =  f'(x^*) \epsilon(t)
\]</div>
<p>Thus we replaced the complicated nonlinear ODE near a fixed point with a linear equation, which approximates the dynamics of the deviation <span class="math notranslate nohighlight">\(\epsilon(t)\)</span> near the fixed point <span class="math notranslate nohighlight">\(x^*\)</span>; note that the derivative <span class="math notranslate nohighlight">\(f'(x^*)\)</span> is a constant for any given fixed point. In section \ref{sec:math15} we classified the behavior of solutions for the general linear ODE <span class="math notranslate nohighlight">\(\dot x = rx\)</span>, and now we apply this classification to the behavior of the deviation <span class="math notranslate nohighlight">\(\epsilon(t)\)</span>. If the multiple <span class="math notranslate nohighlight">\(f'(x^*)\)</span> is positive, the deviation <span class="math notranslate nohighlight">\(\epsilon(t)\)</span> is growing, the solution is diverging away from the fixed point, and thus the fixed point is unstable. If the multiple <span class="math notranslate nohighlight">\(f'(x^*)\)</span> is negative, the deviation <span class="math notranslate nohighlight">\(\epsilon(t)\)</span> is decaying, the solution is converging to the fixed point, and thus the fixed point is stable. Finally, there is the borderline case of <span class="math notranslate nohighlight">\(f'(x^*) = 0\)</span> which is inconclusive, and the fixed point may be either stable or unstable. The \index{differential equation!stability analysis} derivative stability analysis is summarized in the following:</p>
<div class="tip admonition">
<p class="admonition-title">Important Fact</p>
<p>For an autonomous ODE in the form <span class="math notranslate nohighlight">\(\dot x = f(x)\)</span>, a fixed point <span class="math notranslate nohighlight">\(x^*\)</span> can be classified as follows:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(f'(x^*) &gt; 0\)</span>: the slope of <span class="math notranslate nohighlight">\(f(x)\)</span> at the fixed point is positive, then the fixed point is \textbf{unstable}.</p></li>
<li><p><span class="math notranslate nohighlight">\(f'(x^*) &lt; 0\)</span>: the slope of <span class="math notranslate nohighlight">\(f(x)\)</span> at the fixed point is negative, then the fixed point is \textbf{stable}.</p></li>
<li><p><span class="math notranslate nohighlight">\(f'(x^*) = 0\)</span>: stability cannot be determined from the derivative.</p></li>
</ul>
</div>
<p>Therefore, knowing the derivative or the slope of the defining function at the fixed point is enough to know its stability. If the derivative has the discourtesy of being zero, the situation is tricky, because then higher order terms that we neglected make the difference. We will mostly avoid such borderline cases, but they are important in some applications \citep{strogatz_nonlinear_2001}.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The derivative of the defining function <span class="math notranslate nohighlight">\(f'(x)\)</span> is not the second derivative of the solution <span class="math notranslate nohighlight">\(x(t)\)</span>. This is a common mistake, because the function <span class="math notranslate nohighlight">\(f(x)\)</span> is equal to the time derivative of <span class="math notranslate nohighlight">\(x(t)\)</span>. However, the derivative <span class="math notranslate nohighlight">\(f'(x)\)</span> is not with respect to time, it is with respect to x, the dependent variable. In other words, it reflects the slope of the graph of the defining function <span class="math notranslate nohighlight">\(f(x)\)</span>, not the curvature of the graph of the solution <span class="math notranslate nohighlight">\(x(t)\)</span>.</p>
</div>
<p>To summarize, here is an outline of the steps for analyzing the behavior of solutions of an autonomous one-variable ODE. These tasks can be accomplished either by plotting the defining function <span class="math notranslate nohighlight">\(f(x)\)</span> and finding the fixed points and their stability based on the plot, or by solving for the fixed points on paper, then finding the derivative <span class="math notranslate nohighlight">\(f'(x)\)</span> and plugging in the values of the fixed points to determine their stability. Either approach is valid, but the analytic methods are necessary when dealing with models that have unknown parameter values, which makes it impossible to represent the defining function in a plot.</p>
</div>
<div class="section" id="outline-of-qualitative-analysis-of-an-ode">
<h3>Outline of qualitative analysis of an ODE<a class="headerlink" href="#outline-of-qualitative-analysis-of-an-ode" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>find the fixed points by setting the defining function <span class="math notranslate nohighlight">\(f(x)=0\)</span> and solving for values of <span class="math notranslate nohighlight">\(x^*\)</span></p></li>
<li><p>divide the domain of <span class="math notranslate nohighlight">\(x\)</span> into intervals separated by fixed points <span class="math notranslate nohighlight">\(x^*\)</span></p></li>
<li><p>determine on which interval(s) the solution <span class="math notranslate nohighlight">\(x(t)\)</span> is increasing and on which it is decreasing</p></li>
<li><p>use derivative stability analysis (graphically or analytically) to determine which fixed points are stable</p></li>
<li><p>sketch the solutions <span class="math notranslate nohighlight">\(x(t)\)</span> starting at different initial values, based on the stability analysis and whether the solution is increasing or decreasing in a particular interval</p></li>
</ul>
<p><strong>Example: linear model.</strong> Consider the linear ODE that we analyzed above <span class="math notranslate nohighlight">\(dx/dt = 4x -100\)</span>. Let us go through the steps of qualitative analysis:</p>
<ul class="simple">
<li><p>find the fixed points by setting the defining function to 0: <span class="math notranslate nohighlight">\(0 = 4x -100\)</span>, so there is only one fixed point <span class="math notranslate nohighlight">\(x^* = 25\)</span></p></li>
<li><p>divide the domain of <span class="math notranslate nohighlight">\(x\)</span> into intervals separated by fixed points <span class="math notranslate nohighlight">\(x^*\)</span>: the intervals are <span class="math notranslate nohighlight">\(x&lt;25\)</span> and <span class="math notranslate nohighlight">\(x&gt;25\)</span></p></li>
<li><p>the solution is decreasing on the interval <span class="math notranslate nohighlight">\(x&lt;25\)</span> because <span class="math notranslate nohighlight">\(f(x)&lt;0\)</span> there, and the solution is increasing on the interval <span class="math notranslate nohighlight">\(x&gt;25\)</span> because <span class="math notranslate nohighlight">\(f(x)&gt;0\)</span></p></li>
<li><p>the derivative <span class="math notranslate nohighlight">\(f'(x)\)</span> at the fixed point is 4, so the fixed point is <em>unstable</em></p></li>
<li><p>solutions <span class="math notranslate nohighlight">\(x(t)\)</span> starting at different initial values are shown in figure \ref{fig:ch16_flow_linear}b and they behave as follows: solutions with initial values below <span class="math notranslate nohighlight">\(x^*=25\)</span> decreasing, and those with initial values above <span class="math notranslate nohighlight">\(x^*=25\)</span> increasing.</p></li>
</ul>
<p>** Example: logistic model.** \index{model!logistic}\index{function!logistic} Consider the logistic model from the previous subsection,  <span class="math notranslate nohighlight">\(dP/dt =0.3P(1-P/40)\)</span>. We have analyzed the stability of the two fixed points using the plot in figure \ref{fig:ch16_flow_logistic}, and saw that the flow takes the solution away from <span class="math notranslate nohighlight">\(P=0\)</span>, and toward <span class="math notranslate nohighlight">\(P=K\)</span>, thus the first fixed point is unstable, while the second is stable. Let us repeat the analysis using analytic tools:</p>
<ul class="simple">
<li><p>find the fixed points by setting the defining function to 0: <span class="math notranslate nohighlight">\(0 = 0.3P(1-P/40)\)</span>. The two solutions are <span class="math notranslate nohighlight">\(P^*=0\)</span> and <span class="math notranslate nohighlight">\(P^*=40\)</span>.</p></li>
<li><p>divide the domain of <span class="math notranslate nohighlight">\(P\)</span> into intervals separated by fixed points <span class="math notranslate nohighlight">\(P^*\)</span>: the intervals are <span class="math notranslate nohighlight">\(P&lt;0\)</span>; <span class="math notranslate nohighlight">\(0&lt;P&lt;40\)</span>; and <span class="math notranslate nohighlight">\(P&gt;40\)</span></p></li>
<li><p>the solution is decreasing on the interval <span class="math notranslate nohighlight">\(P&lt;0\)</span> because <span class="math notranslate nohighlight">\(f(P)&lt;0\)</span> there, the solution is increasing on the interval <span class="math notranslate nohighlight">\(0&lt;P&lt;40\)</span> because <span class="math notranslate nohighlight">\(f(P)&gt;0\)</span>, and the solution is decreasing  for <span class="math notranslate nohighlight">\(P&gt;40\)</span> because <span class="math notranslate nohighlight">\(f(P)&lt;0\)</span> there</p></li>
<li><p>the derivative is <span class="math notranslate nohighlight">\(f'(P)=0.3-0.3P/20\)</span>; since <span class="math notranslate nohighlight">\(f'(0)=0.3 &gt; 0\)</span>, the fixed point is <em>unstable</em>; since <span class="math notranslate nohighlight">\(P'(40)=-0.3&lt;0\)</span>, the fixed point is <em>stable</em></p></li>
<li><p>solutions <span class="math notranslate nohighlight">\(P(t)\)</span> starting at different initial values are shown in figure \ref{fig:ch16_flow_logistic}b and they behave as follows: solutions with initial values below <span class="math notranslate nohighlight">\(P^*=0\)</span> decreasing, those with initial values between 0 and 40 are increasing and asymptotically approaching 40, and those with initial values above 40 decreasing and asymptotically approaching 40.</p></li>
</ul>
<p>This can be done more generally using the derivative test: taking the derivative of the function on the right-hand-side (with respect to <span class="math notranslate nohighlight">\(P\)</span>), we get <span class="math notranslate nohighlight">\(f'(P)  = r(1-2\frac{P}{K})\)</span>. Assuming <span class="math notranslate nohighlight">\(r&gt;0\)</span> (the population is viable), <span class="math notranslate nohighlight">\(f'(0)= r\)</span> is positive, and the fixed point is therefore unstable. This makes biological sense, since we assumed positive inherent population growth, so given a few individuals, it will increase in size. On the other hand, <span class="math notranslate nohighlight">\(P'(K) = r(1-2) = -r\)</span>, so this fixed point is stable. Thus, according to the logistic model, a population with a positive inherent growth rate will not grow unchecked, like in the exponential model, but will increase until it reaches its carrying capacity, at which it will stay (if all parameters remain constant).</p>
<p><strong>Example: semi-stable fixed point.</strong> Consider the ODE  <span class="math notranslate nohighlight">\(dx/dt =  -x^3 + x^2\)</span>, whose defining function is plotted in figure \ref{fig:ch16_flow_semi}a, showing two fixed points at <span class="math notranslate nohighlight">\(x = 0, 1\)</span>.</p>
<ul class="simple">
<li><p>find the fixed points by setting the defining function to 0: <span class="math notranslate nohighlight">\(0 =  -x^3 + x^2\)</span>. The two fixed points are <span class="math notranslate nohighlight">\(x^*=0\)</span> and <span class="math notranslate nohighlight">\(x^*=1\)</span>.</p></li>
<li><p>divide the domain of <span class="math notranslate nohighlight">\(x\)</span> into intervals separated by fixed points <span class="math notranslate nohighlight">\(x^*\)</span>: the intervals are <span class="math notranslate nohighlight">\(x&lt;0\)</span>; <span class="math notranslate nohighlight">\(0&lt;x&lt;1\)</span>; and <span class="math notranslate nohighlight">\(x&gt;1\)</span></p></li>
<li><p>the solution is increasing on the interval <span class="math notranslate nohighlight">\(x&lt;0\)</span> because <span class="math notranslate nohighlight">\(f(x)&gt;0\)</span> there, the solution is increasing on the interval <span class="math notranslate nohighlight">\(0&lt;x&lt;1\)</span> because <span class="math notranslate nohighlight">\(f(x)&gt;0\)</span>, and the solution is decreasing  for <span class="math notranslate nohighlight">\(x&gt;1\)</span> because <span class="math notranslate nohighlight">\(f(x)&lt;0\)</span> there</p></li>
<li><p>the derivative is <span class="math notranslate nohighlight">\(f'(x)=-3x^2+2x\)</span>; since <span class="math notranslate nohighlight">\(f'(0)=0\)</span>, the fixed point is <em>undetermined</em>; since <span class="math notranslate nohighlight">\(f'(1)=-1&lt;0\)</span>, the fixed point is <em>stable</em>.</p></li>
<li><p>the solutions <span class="math notranslate nohighlight">\(x(t)\)</span> starting at different initial values are shown in figure \ref{fig:ch16_flow_semi}b, and they behave as follows: solutions with initial values below 0 are increasing and asymptotically approaching 0, those with initial values between 0 and 1 are increasing and asymptotically approaching 1, and those with initial values above 1 are decreasing and asymptotically approaching 1.</p></li>
</ul>
<p>This example shows how graphical analysis can help when derivative analysis is undetermined. The red arrows on the x-axis of figure \ref{fig:ch16_flow_semi} show the direction of the flow in the three different regions separated by the fixed points. Flow is to the right for <span class="math notranslate nohighlight">\(x&lt;1\)</span>, to the left for for <span class="math notranslate nohighlight">\(x&gt;1\)</span>; it is clear that the arrows approach the fixed point from both sides, and thus the fixed point  is stable, as the negative slope of <span class="math notranslate nohighlight">\(f(x)\)</span> at  <span class="math notranslate nohighlight">\(x=1\)</span> indicates. One the other hand, the fixed point at <span class="math notranslate nohighlight">\(x=0\)</span> presents a more complicated situation: the slope of <span class="math notranslate nohighlight">\(f(x)\)</span> is zero, and the flow is rightward on both sides of the fixed point. This type of fixed point is sometimes called <em>semi-stable</em>, because it is stable when approached from one side, and unstable when approached from the other.</p>
</div>
</div>
<div class="section" id="modeling-the-spread-of-infectious-disease">
<h2>Modeling the spread of infectious disease<a class="headerlink" href="#modeling-the-spread-of-infectious-disease" title="Permalink to this headline">Â¶</a></h2>
<p>\label{sec:bio16}</p>
<p>The field of \index{model!epidemiology}\index{differential equation!SIS model <em>epidemiology</em> studies the distribution of disease and health states in populations. Epidemiologists describe and model these issues with the goal of helping public health workers devise interventions to improve the overall health outcomes on a large scale. One particular topic of interest is the the spread of infectious disease and how best tor respond to it.. Because epidemiology is concerned with large numbers of people, the models used in the field do not address the details of an individual disease history. One approach to modeling this is to put people into categories, such as <em>susceptible</em> (those who can be infected but are not), <em>infectious</em> (those who are infected and can spread the disease), and <em>recovered</em> (those who cannot be infected or spread disease). This type of models is called a \index{epidemic!compartment model} <em>compartment model</em> and they are they commonly used to represent infectious disease on a population level both for deterministic models (e.g. ODEs) and stochastic models (e.g. Markov models). Dividing people into categories involves the assumption that everyone in a particular category behaves in the same manner: for instance, all susceptible people are infected with the same rate and all infected people recover with the same rate.</p>
<p>Let us construct an ODE to describe a two-compartment epidemiology model. There are two dependent variables to be tracked: the number of susceptible (<span class="math notranslate nohighlight">\(S\)</span>) and infected (<span class="math notranslate nohighlight">\(I\)</span>) individuals in the population. The susceptible individuals can get infected, while the infected ones can recover and become susceptible again. The implicit assumption is that there is no immunity, and recovered individuals can get infected with the same ease as those who were never infected. There are some human diseases for which this is true, for instance the common cold or gonorrhea. Transitions between the different classes of individuals can be summarized by the following scheme:
$<span class="math notranslate nohighlight">\( S + I \xrightarrow{\beta} I \xrightarrow{\gamma} S \)</span><span class="math notranslate nohighlight">\(
Here \)</span>\beta<span class="math notranslate nohighlight">\( is the individual rate of infection, also known as the transmission rate, and \)</span>\gamma<span class="math notranslate nohighlight">\( is the individual rate of recovery. There is an important distinction between the processes of infection and recovery: the former requires an infected individual and a susceptible individual, while the latter needs only an infected individual. Therefore, it is reasonable to suppose that the rate of growth of infected individuals is the product of the individual transmission rate \)</span>\beta<span class="math notranslate nohighlight">\( and the product of the number of infected and susceptible individuals. The overall rate of recovery is the individual recovery rate \)</span>\gamma<span class="math notranslate nohighlight">\( multiplied by the number of the infected. This leads to the following two differential equations:
\begin{eqnarray*}
\dot S &amp;=&amp; -\beta IS + \gamma I \\
\dot I &amp; = &amp;\beta I S - \gamma I
\end{eqnarray*}
Note that, as in the chemical kinetics models, the two equations add up to zero on the right hand side, leading to the conclusion that \)</span>\dot S + \dot I = 0<span class="math notranslate nohighlight">\(. Therefore, the total number of people is a conserved quantity \)</span>N$, which does not change. This makes sense since we did not consider any births or deaths in the ODE model, only transitions between susceptible and infected individuals.</p>
<p>We can use the conserved quantity <span class="math notranslate nohighlight">\(N\)</span> to reduce the two equations to one, by the substitution of <span class="math notranslate nohighlight">\(S = N -I\)</span>:
$<span class="math notranslate nohighlight">\(  \dot I  =  \beta I (N - I) - \gamma I \)</span><span class="math notranslate nohighlight">\(
This model may be analyzed using qualitative methods that were developed in this chapter, allowing prediction of the dynamics of the fraction of infected for different transmission and recovery rates.  First, let us find the fixed points of the differential equation. Setting the equation to zero, we find:
\)</span><span class="math notranslate nohighlight">\( 0  =  \beta I (N - I) - \gamma I \Rightarrow I^* = 0; \; I^* =  N - \gamma/\beta \)</span><span class="math notranslate nohighlight">\(
This means that there are two equilibrium levels of infection: either nobody is infected (\)</span>I^* = 0<span class="math notranslate nohighlight">\() or there is some persistent number of infected individuals (\)</span> I^* =  N - \gamma/\beta <span class="math notranslate nohighlight">\(). Notice that the second fixed point is only biologically relevant if \)</span>N &gt; \gamma/\beta $.</p>
<p>Use the derivative test to check for stability. First, find the general expression for derivative of the defining function: <span class="math notranslate nohighlight">\(f'(I) = -2 \beta I + \beta N - \gamma \)</span>.
\begin{figure}[htbp] %  figure placement: here, top, bottom, or page</p>
<div class="highlight-{r notranslate"><div class="highlight"><pre><span></span># defining function for the SI ODE dx/dt = -beta*(S)*(N-S)+gamma*(N-S)
SI_funk &lt;- function (I,N,beta,gamma){
  return(beta*(I)*(N-I)-gamma*I)
}

beta &lt;- 0.5
gamma &lt;- 0.2
N &lt;- 1
x&lt;-seq(-0.2,1.2*N,0.01)
y &lt;- SI_funk(x,N,beta,gamma)
plot(x,y,t=&quot;l&quot;,xlab=&quot;I (fraction of infected)&quot;, ylab=&quot;dI/dt&quot;,lwd=3, cex=1.5, cex.axis=1.5,cex.lab=1.5)
abline(0,0,lwd=2)
arrows(0.1,0,N-gamma/beta-0.02,0,length=0.3,angle=30,lwd=6,col=&#39;red&#39;)
arrows(1.2*N,0,N-gamma/beta+0.02,0,length=0.3,angle=30,lwd=6,col=&#39;red&#39;)

dt &lt;- 0.01 # set time step
Tmax &lt;- 15 # set length of time
Nstep &lt;- Tmax/dt # calculate number of time steps 
init_value &lt;- 0.1 # set initial value 
y &lt;- matrix(init_value,nrow=1, ncol=Nstep+1) # initialize the solution vectors with init_value
t &lt;- dt*(0:Nstep)
for (i in 1:Nstep){
  y[i+1] &lt;- y[i]+dt*SI_funk(y[i],N,beta,gamma)
}
# plot the solution vs time
# plot the numeric solution vs time
plot(t,y,t=&#39;l&#39;,xlab=&#39;time&#39;,ylab=&#39;fraction of infected&#39;,ylim=c(0,1.1),lwd=3, cex=1.5, cex.axis=1.5,cex.lab=1.5)

# another initial value
init_value &lt;- 0.5 # set initial value 
y &lt;- matrix(init_value,nrow=1, ncol=Nstep+1) # initialize the solution vectors with init_value
t &lt;- dt*(0:Nstep)
for (i in 1:Nstep){
  y[i+1] &lt;- y[i]+dt*SI_funk(y[i],N,beta,gamma)
}
lines(t,y,lwd=3, cex=1.5, cex.axis=1.5,cex.lab=1.5)

# another initial value
init_value &lt;- 0.9 # set initial value 
y &lt;- matrix(init_value,nrow=1, ncol=Nstep+1) # initialize the solution vectors with init_value
t &lt;- dt*(0:Nstep)
for (i in 1:Nstep){
  y[i+1] &lt;- y[i]+dt*SI_funk(y[i],N,beta,gamma)
}
lines(t,y,lwd=3, cex=1.5, cex.axis=1.5,cex.lab=1.5)

abline(0,0,lty=2,lwd=2)
abline(N-gamma/beta,0,lty=2,lwd=2)
</pre></div>
</div>
<div class="highlight-{r notranslate"><div class="highlight"><pre><span></span># defining function for the SI ODE dx/dt = -beta*(S)*(N-S)+gamma*(N-S)
SI_funk &lt;- function (I,N,beta,gamma){
  return(beta*(I)*(N-I)-gamma*I)
}

beta &lt;- 0.2
gamma &lt;- 0.3
N &lt;- 1
x&lt;-seq(-0.5,1.2*N,0.01)
y &lt;- SI_funk(x,N,beta,gamma)
plot(x,y,t=&quot;l&quot;,xlab=&quot;I (fraction of infected)&quot;, ylab=&quot;dI/dt&quot;,lwd=3, cex=1.5, cex.axis=1.5,cex.lab=1.5)
abline(0,0,lwd=2)
arrows(1.2*N,0,0.02,0,length=0.3,angle=30,lwd=6,col=&#39;red&#39;)
arrows(N-gamma/beta+0.02,0,-0.02,0,length=0.3,angle=30,lwd=6,col=&#39;red&#39;)

dt &lt;- 0.01 # set time step
Tmax &lt;- 15 # set length of time
Nstep &lt;- Tmax/dt # calculate number of time steps 
init_value &lt;- 0.1 # set initial value 
y &lt;- matrix(init_value,nrow=1, ncol=Nstep+1) # initialize the solution vectors with init_value
t &lt;- dt*(0:Nstep)
for (i in 1:Nstep){
  y[i+1] &lt;- y[i]+dt*SI_funk(y[i],N,beta,gamma)
}
# plot the solution vs time
# plot the numeric solution vs time
plot(t,y,t=&#39;l&#39;,xlab=&#39;time&#39;,ylab=&#39;fraction of infected&#39;,ylim=c(-0.5,1),lwd=3, cex=1.5, cex.axis=1.5,cex.lab=1.5)

# another initial value
init_value &lt;- 0.5 # set initial value 
y &lt;- matrix(init_value,nrow=1, ncol=Nstep+1) # initialize the solution vectors with init_value
t &lt;- dt*(0:Nstep)
for (i in 1:Nstep){
  y[i+1] &lt;- y[i]+dt*SI_funk(y[i],N,beta,gamma)
}
lines(t,y,lwd=3, cex=1.5, cex.axis=1.5,cex.lab=1.5)

# another initial value
init_value &lt;- 0.9 # set initial value 
y &lt;- matrix(init_value,nrow=1, ncol=Nstep+1) # initialize the solution vectors with init_value
t &lt;- dt*(0:Nstep)
for (i in 1:Nstep){
  y[i+1] &lt;- y[i]+dt*SI_funk(y[i],N,beta,gamma)
}
lines(t,y,lwd=3, cex=1.5, cex.axis=1.5,cex.lab=1.5)

abline(0,0,lty=2,lwd=2)
abline(N-gamma/beta,0,lty=2,lwd=2)
</pre></div>
</div>
<p>The stability of the fixed point <span class="math notranslate nohighlight">\(I^* = 0\)</span> is found by plugging in this value into the derivative formula: <span class="math notranslate nohighlight">\(f'(0) = \beta N - \gamma \)</span>. We learned in section \ref{sec:math16} that a fixed point is stable if the derivative of the defining function is negative. Therefore, <span class="math notranslate nohighlight">\(I^* = 0\)</span> is stable if <span class="math notranslate nohighlight">\(\gamma - \beta N &gt; 0\)</span>, and unstable otherwise. This gives us a \index{differential equation!stability condition}\emph{stability condition} on the values of the biological parameters. If the recovery rate <span class="math notranslate nohighlight">\(\gamma\)</span> is greater than the rate of infection for the population (the transmission rate multiplied by the population size) <span class="math notranslate nohighlight">\(\beta N\)</span>, then the no-infection equilibrium is stable. This predicts that the infection dies out if the recovery rate is faster than the rate of infection, which makes biological sense.</p>
<p>Similarly, we find the stability of the second fixed point <span class="math notranslate nohighlight">\(I^* =  N - \gamma/\beta\)</span> by substituting its value into the derivative, to obtain <span class="math notranslate nohighlight">\(f'(N - \gamma/\beta) = \gamma  - \beta N\)</span>. By the same logic, as above, this fixed point is stable if <span class="math notranslate nohighlight">\(\gamma  - \beta N  &lt; 0\)</span>, or if <span class="math notranslate nohighlight">\(\gamma &lt; \beta N\)</span>. This is a complementary condition for the fixed point at 0, that is, only one fixed point can be stable for any given parameter values. In the biological interpretation, if the transmission rate <span class="math notranslate nohighlight">\(\beta N\)</span> is greater than the recovery rate <span class="math notranslate nohighlight">\(\gamma\)</span>, then the epidemic will persist.</p>
<p>We can use our graphical analysis skills to illustrate the situation. Consider a situation in which <span class="math notranslate nohighlight">\(\gamma &lt; \beta N\)</span>. As predicted by stability analysis, the  zero infection equilibrium should be unstable, and the equilibrium at <span class="math notranslate nohighlight">\(N - \gamma/\beta\)</span> should be stable. In order to plot the function <span class="math notranslate nohighlight">\(f(I) =  \beta I (N - I) - \gamma I \)</span>, we choose the specific parameter values <span class="math notranslate nohighlight">\(N=1\)</span>, <span class="math notranslate nohighlight">\(\gamma = 0.1\)</span> and <span class="math notranslate nohighlight">\(\beta = 0.2\)</span>; setting <span class="math notranslate nohighlight">\(N=1\)</span> means <span class="math notranslate nohighlight">\(S\)</span> and <span class="math notranslate nohighlight">\(I\)</span> represent the fraction of the population in the susceptible and infected categories. Figure \ref{fig:ch16_flow_sis1}a shows the direction of the flow on the <span class="math notranslate nohighlight">\(I\)</span>-axis prescribed by the defining function <span class="math notranslate nohighlight">\(f(I)\)</span> with red arrows.  It is clear that solutions approach the fixed point at <span class="math notranslate nohighlight">\(N - \gamma/\beta\)</span>  from both directions, which make it a stable fixed point, while diverging from <span class="math notranslate nohighlight">\(I=0\)</span>, as shown in figure \ref{fig:ch16_flow_sis1}b.</p>
<p>On the other hand, if <span class="math notranslate nohighlight">\(\gamma &gt; \beta N\)</span>, stability analysis predicts that the no-infection equilibrium (<span class="math notranslate nohighlight">\(I=0\)</span>) is stable.  Figure \ref{fig:ch16_flow_sis2}a shows the plot of the defining function for the parameter values  <span class="math notranslate nohighlight">\(N=1\)</span>, <span class="math notranslate nohighlight">\(\gamma = 0.3\)</span> and <span class="math notranslate nohighlight">\(\beta = 0.2\)</span>. The flow on the <span class="math notranslate nohighlight">\(I\)</span>-axis is toward the zero equilibrium, therefore it is stable. Note that the second equilibrium at <span class="math notranslate nohighlight">\(I^* =  N - \gamma/\beta\)</span> is negative, and thus has no biological significance. The solutions, if the initial value is positive, all approach 0, so the infection inevitably dies out.</p>
<p>Mathematical modeling of epidemiology has been a success story in the last few decades. Public health workers routinely estimate the \index{parameter!basic reproductive number}parameter called the \index{epidemic!basic reproductive number} <em>basic reproductive number</em> <span class="math notranslate nohighlight">\(R_0\)</span> defined to be the average number of new infections caused by a single infected individual in a susceptible population. This number comes out of our analysis above, where we found <span class="math notranslate nohighlight">\(R_0 = N \beta/\gamma\)</span> to determine whether or not an epidemic persisted \citep{brauer_mathematical_2011}. This number is critical in more sophisticated models of epidemiology.</p>
<p>Mathematical models are used to predict the time course of an epidemic, called the \index{epidemic!curve} <em>epidemic curve</em> and then advise on the public health interventions that can reduce the number of affected individuals. In reality, most epidemic curves have the shape similar to the data from the Ebola virus epidemic in figure \ref{fig:ch16-ebola}. Most such curves show an initial increase in infections, peaking, and the declining to low levels, which is fundamentally different than the solution curves we obtained from the two-compartment model. To describe dynamics of this nature, models with more than two variables are needed, such as classic three-compartment SIR models (susceptible-infected-recovered) models and their modifications \citep{brauer_mathematical_2011}. Being able to predict the future of an epidemic based on <span class="math notranslate nohighlight">\(R_0\)</span> and other parameters allows public health officials to prepare and deploy interventions (vaccinations, quarantine, etc.) that have the best shot at minimizing the epidemic.</p>
<div class="highlight-{r notranslate"><div class="highlight"><pre><span></span>liberia &lt;- read.table(&#39;data/ebola_liberia.txt&#39;,header=TRUE)
barplot(liberia$cases,names.arg=liberia$week,xlab=&#39;time (weeks)&#39;,axisnames=TRUE,ylab=&#39;new ebola cases&#39;,col=2,cex=1.5, cex.axis=1.5,cex.lab=1.5)
SL &lt;- read.table(&#39;data/ebola_SL.txt&#39;,header=TRUE)
evens &lt;- seq(2,122,2)
barplot(SL$cases[evens],names.arg=SL$week[evens]/2,xlab=&#39;time (weeks)&#39;,axisnames=TRUE,ylab=&#39;new ebola cases&#39;,col=2,cex=1.5, cex.axis=1.5,cex.lab=1.5)
</pre></div>
</div>
</div>
</div>
<div class="section" id="graphical-and-qualitative-analysis-of-odes">
<h1>Graphical and qualitative analysis of ODEs<a class="headerlink" href="#graphical-and-qualitative-analysis-of-odes" title="Permalink to this headline">Â¶</a></h1>
<div class="section" id="fixed-points-in-ode">
<h2>fixed points in ODE<a class="headerlink" href="#fixed-points-in-ode" title="Permalink to this headline">Â¶</a></h2>
<p>Generally, ODE models for realistic biological systems are nonlinear,
and most nonlinear differential equations cannot be solved analytically.
Instead, we will analyze the behavior of the solutions without finding
an exact formula. The first step to understanding the dynamics of an ODE
is finding its fixed points. The concept is the same as in the case of
difference equations: a fixed point is a value of the solution at which
the dynamical system stays constant. Thus, the derivative of the
solution must be zero, which leads us to to the formal definition:</p>
<p>For a differential equation <span class="math notranslate nohighlight">\(\dot x = f(x)\)</span>, a point <span class="math notranslate nohighlight">\(x^*\)</span> which
satisfies <span class="math notranslate nohighlight">\(f(x^*)=0\)</span> is called a <em>fixed point</em> or <em>equilibrium</em>, and the
solution with the initial condition <span class="math notranslate nohighlight">\(x(0)=x^*\)</span> is <span class="math notranslate nohighlight">\(x(t)=x^*\)</span>.</p>
<p>For instance, the linear equation <span class="math notranslate nohighlight">\(\dot x  = rx\)</span> has a single fixed
point at <span class="math notranslate nohighlight">\(x^* = 0\)</span>. For a more interesting example, consider a logistic
equation: <span class="math notranslate nohighlight">\(\dot x = x - x^2 \)</span>. Its fixed points are the solutions of
<span class="math notranslate nohighlight">\(x - x^2 = 0\)</span>, therefore there two fixed points: <span class="math notranslate nohighlight">\(x^* = 0, 1\)</span>. We know
that if the solution has either of the fixed points as the initial
condition, it will remain at that value for all time.</p>
<p>Locating the fixed points is not sufficient to predict the global
behavior of the dynamical system, however. The next question to address
is the behavior of the solution if the initial condition is <strong>near</strong> the
fixed point. This is the same notion of stability that we saw for
discrete dynamical systems. The definition is identical:</p>
<p>A fixed point <span class="math notranslate nohighlight">\(x^*\)</span> of an ODE <span class="math notranslate nohighlight">\(\dot x = f(x)\)</span> is called <em>stable (sink)</em>,
if for a sufficiently small number <span class="math notranslate nohighlight">\(\epsilon\)</span>, the solution <span class="math notranslate nohighlight">\(x(t)\)</span> with
the initial condition <span class="math notranslate nohighlight">\(x_0 = x^* + \epsilon\)</span> approaches the fixed point
<span class="math notranslate nohighlight">\(x^*\)</span> as <span class="math notranslate nohighlight">\(t \rightarrow \infty\)</span>. If the solution <span class="math notranslate nohighlight">\(x(t)\)</span> does not
approach <span class="math notranslate nohighlight">\(x^*\)</span> for all nonzero <span class="math notranslate nohighlight">\(\epsilon\)</span>, the fixed point is called
<em>unstable (source)</em>.</p>
<p>We will see that the slope of <span class="math notranslate nohighlight">\(f(x)\)</span> determines whether a fixed point is
stable. We use the same methodology as we did in Chapter 1. First,
define <span class="math notranslate nohighlight">\(\epsilon(t)\)</span> to be the deviation of the solution <span class="math notranslate nohighlight">\(x(t)\)</span> from the
fixed point <span class="math notranslate nohighlight">\(x^*\)</span>, that is, write <span class="math notranslate nohighlight">\(x(t) = x^* + \epsilon(t)\)</span>. Assuming
that <span class="math notranslate nohighlight">\(\epsilon(t)\)</span> is small, we can write the function <span class="math notranslate nohighlight">\(f(x)\)</span> using
Taylorâs formula:
$<span class="math notranslate nohighlight">\(f(x^*+\epsilon(t))= f(x^*)+f'(x^*) \epsilon(t) + ... = f'(x^*) \epsilon(t) + ...\)</span><span class="math notranslate nohighlight">\(
The term \)</span>f(x^<em>)<span class="math notranslate nohighlight">\( vanished because it is zero by definition of a fixed
point. The ellipsis indicates terms of order \)</span>\epsilon(t)^2<span class="math notranslate nohighlight">\( and higher,
which are very small by assumption. Thus, we can write the following
approximation to the ODE \)</span>\dot x = f(x)<span class="math notranslate nohighlight">\( near a fixed point:
\)</span><span class="math notranslate nohighlight">\(\dot x =  \frac{ d(x^* + \epsilon(t))}{dt} = \dot \epsilon(t) =  f'(x^*) \epsilon(t)\)</span><span class="math notranslate nohighlight">\(
This differential equation describes the dynamics of the deviation
\)</span>\epsilon(t)<span class="math notranslate nohighlight">\( near the fixed point \)</span>x^</em><span class="math notranslate nohighlight">\(; note that the derivative
\)</span>fâ(x^*)<span class="math notranslate nohighlight">\( is a constant for any given fixed point. We have obtained a
linear equation for \)</span>\epsilon(t)<span class="math notranslate nohighlight">\(, known as the linearization of the ODE
near the fixed point. We have classified the behavior of solutions for
the general linear ODE \)</span>\dot x = rx<span class="math notranslate nohighlight">\(, and now we apply this
classification to the behavior of the deviation \)</span>\epsilon(t)$:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(f'(x^*) &gt; 0\)</span>: the deviation <span class="math notranslate nohighlight">\(\epsilon(t)\)</span> grows exponentially, and
the solution moves away from the fixed point <span class="math notranslate nohighlight">\(x^*\)</span>, therefore the
fixed point is <strong>unstable</strong>.</p></li>
<li><p><span class="math notranslate nohighlight">\(f'(x^*) &lt; 0\)</span>: the deviation <span class="math notranslate nohighlight">\(\epsilon(t)\)</span> decays to 0, therefore
the fixed point is <strong>stable</strong>.</p></li>
<li><p><span class="math notranslate nohighlight">\(f'(x^*) = 0\)</span>: the situation is more complicated.</p></li>
</ul>
<p>The classification of the behavior near a fixed point is directly
analogous to that in discrete time models, with the difference that the
discrimination between stable and unstable depends on the sign of the
derivative, rather than whether its absolute value is greater than or
less than 1. As before, the borderline situation is tricky, because if
the first derivative is zero, higher order terms that we neglected make
the difference. We will mostly avoid such borderline cases, but they are
important in some applications.</p>
<p>We have learned to find fixed points and analyze their stability. This
will be the bedrock of our analysis of continuous-time dynamical
systems, first in one variable and then in higher dimensions.</p>
</div>
<div class="section" id="plotting-flow-on-the-line">
<h2>plotting flow on the line<a class="headerlink" href="#plotting-flow-on-the-line" title="Permalink to this headline">Â¶</a></h2>
<p>The defining function of the ODE <span class="math notranslate nohighlight">\(\dot x = f(x)\)</span> gives the rate of
change of <span class="math notranslate nohighlight">\(x(t)\)</span> depending on the value of <span class="math notranslate nohighlight">\(x\)</span>. If <span class="math notranslate nohighlight">\(f(x)\)</span> is large and
positive, that means the dependent variable <span class="math notranslate nohighlight">\(x(t)\)</span> is increasing
rapidly. If <span class="math notranslate nohighlight">\(f(x)\)</span> is small and negative, <span class="math notranslate nohighlight">\(x(t)\)</span> is decreasing at a slow
rate. If <span class="math notranslate nohighlight">\(f(x)=0\)</span>, this value of <span class="math notranslate nohighlight">\(x\)</span> is a fixed point, and <span class="math notranslate nohighlight">\(x\)</span> is not
changing at all.</p>
<p>For an ODE with one dependent variable, we can sketch the <em>flow on the
line</em> defined by the differential equation. The âflowâ stands for the
direction of change at every point, specifically increasing, decreasing,
or not changing. We will plot the flow on the horizontal x-axis, so if
<span class="math notranslate nohighlight">\(x\)</span> is increasing, the flow will be indicated by a rightward arrow, and
if it is decreasing, the flow will point to the left. The fixed points
separate the regions of increasing (rightward) flow and decreasing
(leftward) flow.</p>
<p>The graphical approach to finding areas of right and left flow is based
on graphing the function <span class="math notranslate nohighlight">\(f(x)\)</span>, and dividing the x-axis based on the
sign of <span class="math notranslate nohighlight">\(f(x)\)</span>. In the areas where <span class="math notranslate nohighlight">\(f(x) &gt; 0\)</span>, its graph is above the
x-axis, and the flow is to the right; conversely, when <span class="math notranslate nohighlight">\(f(x) &lt; 0\)</span>, its
graph is below the x-axis, and the flow is to the left. The fixed points
are found at the intersections of the graph of <span class="math notranslate nohighlight">\(f(x)\)</span> with the x-axis.</p>
<p>Graphical analysis is also used to determine the stability of fixed
points. To summarize, a fixed point <span class="math notranslate nohighlight">\(x^*\)</span> is defined by <span class="math notranslate nohighlight">\(f(x^*) = 0\)</span>. We
saw above, the slope of <span class="math notranslate nohighlight">\(f(x)\)</span> at a fixed point determines its stability
[&#64;strogatz_nonlinear_2001]:</p>
<ul class="simple">
<li><p>if the slope of the graph of <span class="math notranslate nohighlight">\(f(x^*)\)</span> is negative, the fixed point
is stable</p></li>
<li><p>if the slope of the graph of <span class="math notranslate nohighlight">\(f(x^*)\)</span> is positive, the fixed point
is unstable</p></li>
<li><p>if the slope of the graph of <span class="math notranslate nohighlight">\(f(x^*)\)</span> is zero (<span class="math notranslate nohighlight">\(f(x^*)\)</span> just touches
the x-axis), then further analysis is needed to determine stability.</p></li>
</ul>
</div>
<div class="section" id="models-with-nonlinear-terms-logistic-model">
<h2>models with nonlinear terms: logistic model<a class="headerlink" href="#models-with-nonlinear-terms-logistic-model" title="Permalink to this headline">Â¶</a></h2>
<p>We have already seen the logistic population model in discrete time. The
motivation and the form of the model are the same as before: population
growth is generally slower at larger populations, which can be expressed
as a higher death rate or a lower birth date, or both. We will assume
there are separate birth and death rates, and that the birth rate
declines as the population grows, while the death rate increases.
Suppose there are inherent birth rates <span class="math notranslate nohighlight">\(b\)</span> and <span class="math notranslate nohighlight">\(d\)</span>, and the overall
birth and death rates <span class="math notranslate nohighlight">\(B\)</span> and <span class="math notranslate nohighlight">\(D\)</span> depend linearly on population size
<span class="math notranslate nohighlight">\(P\)</span>: <span class="math notranslate nohighlight">\(B  =  b - aP \)</span> and <span class="math notranslate nohighlight">\(D  =  d + cP \)</span></p>
<p>To model the actual rate of change of the population, we need to
multiply the rates <span class="math notranslate nohighlight">\(B\)</span> and <span class="math notranslate nohighlight">\(D\)</span> by the population size <span class="math notranslate nohighlight">\(P\)</span>, since each
individual can reproduce or die. Also, since the death rate <span class="math notranslate nohighlight">\(D\)</span>
decreases the population, we need to put a negative sign on it. The
resultant model is: $<span class="math notranslate nohighlight">\(\dot P = BP - DP = [(b-d)-(a+c)P]P\)</span><span class="math notranslate nohighlight">\( The
parameters of the model, the constants \)</span>a,b,c,d<span class="math notranslate nohighlight">\(, have different
meanings. Performing dimensional analysis, we find that \)</span>b<span class="math notranslate nohighlight">\( and \)</span>d<span class="math notranslate nohighlight">\( have
the units of \)</span>1/[t]<span class="math notranslate nohighlight">\(, the same as the rate \)</span>r<span class="math notranslate nohighlight">\( in the exponential growth
model. However, the units of \)</span>a<span class="math notranslate nohighlight">\( (and \)</span>c<span class="math notranslate nohighlight">\() must obey the relation:
\)</span>[P]/[t] = [a][P]^2<span class="math notranslate nohighlight">\(, and thus, \)</span><span class="math notranslate nohighlight">\([a]=[c] = \frac{1}{[t][P]}\)</span>$</p>
<p>This shows that the constants <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(c\)</span> have to be treated differently
than <span class="math notranslate nohighlight">\(b\)</span> and <span class="math notranslate nohighlight">\(d\)</span>. Let us define the inherent growth rate of the
population, to be <span class="math notranslate nohighlight">\(r_0=b-d\)</span> (if the death rate is greater than the birth
rate, the population will inherently decline). Then let us introduce
another constant <span class="math notranslate nohighlight">\(K\)</span>, such that <span class="math notranslate nohighlight">\((a+c)=r_0/K\)</span>. It should be clear from
the dimensional analysis that <span class="math notranslate nohighlight">\(K\)</span> has units of <span class="math notranslate nohighlight">\(P\)</span>, population size. Now
we can write down the logistic equation in the canonical form:
$<span class="math notranslate nohighlight">\(\dot P = r(1-\frac{P}{K})P
\label{eq:log_cont_model}\)</span><span class="math notranslate nohighlight">\( This model can be re-written as
\)</span>\dot P = aP -bP^2<span class="math notranslate nohighlight">\(, so it is clear that there is a *linear term* (\)</span>aP<span class="math notranslate nohighlight">\()
and a *nonlinear term* (\)</span>-bP^2<span class="math notranslate nohighlight">\(). When \)</span>P<span class="math notranslate nohighlight">\( is sufficiently small (and
positive) the linear term is greater, and the population grows. When \)</span>P$
is large enough, the nonlinear term wins and the population declines.</p>
<p>It should be apparent that there are two fixed points, at <span class="math notranslate nohighlight">\(P=0\)</span> and at
<span class="math notranslate nohighlight">\(P=K\)</span>. The first one corresponds to a population with no individuals. On
the other hand, <span class="math notranslate nohighlight">\(K\)</span> signifies the population at which the negative
effect of population size balances out the inherent population growth
rate, and is called the <em>carrying capacity</em> of a population in its
environment. We will analyze the stability of these fixed points in the
analytical section of this chapter.</p>
<p><img alt="Line flow analysis of the logistic model ; redarrows indicate the direction field in the intervals separated by thefixedpoints[]{data-label=&quot;fig:line_flow_logistic&quot;}" src="_images/lec2_fig2.jpg" />{width=â4inâ}</p>
<p><strong>Example: semi-stable fixed point.</strong> The function <span class="math notranslate nohighlight">\(f(x) =  -x^3 + x^2 \)</span>
is plotted in figure , showing two fixed
points at <span class="math notranslate nohighlight">\(x = 0, 1\)</span>. The red arrows on the x-axis show the direction of
the flow in the three different regions separated by the fixed points.
Flow is to the right for <span class="math notranslate nohighlight">\(x&lt;1\)</span>, to the left for for <span class="math notranslate nohighlight">\(x&gt;1\)</span>; it is plain
to see that the arrows approach the fixed point from both sides, and
thus the fixed point is stable, as the negative slope of <span class="math notranslate nohighlight">\(f(x)\)</span> at <span class="math notranslate nohighlight">\(x=1\)</span>
indicates. The fixed point at <span class="math notranslate nohighlight">\(x=0\)</span> presents a more complicated
situation: the slope of <span class="math notranslate nohighlight">\(f(x)\)</span> is zero, and the flow is rightward on
both sides of the fixed point. This type of fixed point is sometimes
called <em>semi-stable</em>, because it is stable when approached from one
side, and unstable when approached from the other.</p>
<p><img alt="Line flow analysis of the nonlinear ODE ; redarrows indicate the direction field in the intervals separated by thefixedpoints.[]{data-label=&quot;fig:line_flow_example&quot;}" src="_images/lec2_fig1.jpg" />{width=â4inâ}</p>
</div>
<div class="section" id="sis-model-of-epidemics">
<h2>SIS model of epidemics<a class="headerlink" href="#sis-model-of-epidemics" title="Permalink to this headline">Â¶</a></h2>
<p>The field of <em>epidemiology</em> studies the distribution of disease and
health states in populations. Epidemiologists describe and model these
issues with the goal of helping public health workers devise
interventions to improve the overall health outcomes on a large scale.
One particular topic of interest is the the spread of infectious disease
and how best tor respond to it.. Because epidemiology is concerned with
large numbers of people, the models used in the field do not address the
details of an individual disease history. One approach to modeling this
is to put people into categories, which is called a <em>compartment model</em>.
Dividing people into categories involves the assumption that everyone in
a particular category behaves in the same manner: for instance, all
susceptible people are infected with the same rate and all infected
people recover with the same rate.</p>
<p>Let us construct an ODE to describe a two-compartment epidemiology
model. There are two dependent variables to be tracked: the number of
susceptible (<span class="math notranslate nohighlight">\(S\)</span>) and infected (<span class="math notranslate nohighlight">\(I\)</span>) individuals in the population. The
susceptible individuals can get infected, while the infected ones can
recover and become susceptible again. The implicit assumption is that
there is no immunity, and recovered individuals can get infected with
the same ease as those who were never infected. There are some human
diseases for which this is true, for instance the common cold or
gonorrhea. Transitions between the different classes of individuals can
be summarized by the following scheme:
$<span class="math notranslate nohighlight">\(S + I \xrightarrow{\beta} I \xrightarrow{\gamma} S\)</span><span class="math notranslate nohighlight">\( Here \)</span>\beta<span class="math notranslate nohighlight">\( is
the individual rate of infection, also known as the transmission rate,
and \)</span>\gamma<span class="math notranslate nohighlight">\( is the individual rate of recovery. There is an important
distinction between the processes of infection and recovery: the former
requires an infected individual and a susceptible individual, while the
latter needs only an infected individual. Therefore, it is reasonable to
suppose that the rate of growth of infected individuals is the product
of the individual transmission rate \)</span>\beta<span class="math notranslate nohighlight">\( and the product of the
number of infected and susceptible individuals. The overall rate of
recovery is the individual recovery rate \)</span>\gamma<span class="math notranslate nohighlight">\( multiplied by the
number of the infected. This leads to the following two differential
equations: \)</span><span class="math notranslate nohighlight">\(\begin{aligned}
\dot S &amp;=&amp; -\beta IS + \gamma I \\
\dot I &amp; = &amp;\beta I S - \gamma I\end{aligned}\)</span><span class="math notranslate nohighlight">\( Note that, as in the
chemical kinetics models, the two equations add up to zero on the right
hand side, leading to the conclusion that \)</span>\dot S + \dot I = 0<span class="math notranslate nohighlight">\(.
Therefore, the total number of people is a conserved quantity \)</span>N$, which
does not change. This makes sense since we did not consider any births
or deaths in the ODE model, only transitions between susceptible and
infected individuals.</p>
<p>We can use the conserved quantity <span class="math notranslate nohighlight">\(N\)</span> to reduce the two equations to
one, by the substitution of <span class="math notranslate nohighlight">\(S = N -I\)</span>:
$<span class="math notranslate nohighlight">\(\dot I  =  \beta I (N - I) - \gamma I\)</span><span class="math notranslate nohighlight">\( This model may be analyzed
using qualitative methods that were developed in this chapter, allowing
prediction of the dynamics of the fraction of infected for different
transmission and recovery rates. First, let us find the fixed points of
the differential equation. Setting the equation to zero, we find:
\)</span><span class="math notranslate nohighlight">\(0  =  \beta I (N - I) - \gamma I \Rightarrow I^* = 0; \; I^* =  N - \gamma/\beta\)</span><span class="math notranslate nohighlight">\(
This means that there are two equilibrium levels of infection: either
nobody is infected (\)</span>I^* = 0<span class="math notranslate nohighlight">\() or there is some persistent number of
infected individuals (\)</span> I^* =  N - \gamma/\beta <span class="math notranslate nohighlight">\(). Notice that the
second fixed point is only biologically relevant if \)</span>N &gt; \gamma/\beta $.</p>
<p>We can use the derivative test to check for stability. First, find the
general expression for derivative of the defining function:
<span class="math notranslate nohighlight">\(f'(I) = -2 \beta I + \beta N - \gamma \)</span>. The stability of the fixed
point <span class="math notranslate nohighlight">\(I^* = 0\)</span> is found by plugging in this value into the derivative
formula: <span class="math notranslate nohighlight">\(f'(0) = \beta N - \gamma \)</span>. Therefore, <span class="math notranslate nohighlight">\(I^* = 0\)</span> is stable if
<span class="math notranslate nohighlight">\(\gamma - \beta N &gt; 0\)</span>, and unstable otherwise. This gives us a
<em>stability condition</em> on the values of the biological parameters. If the
recovery rate <span class="math notranslate nohighlight">\(\gamma\)</span> is greater than the rate of infection for the
population (the transmission rate multiplied by the population size)
<span class="math notranslate nohighlight">\(\beta N\)</span>, then the no-infection equilibrium is stable. This predicts
that the infection dies out if the recovery rate is faster than the rate
of infection, which makes biological sense.</p>
<p>Similarly, we find the stability of the second fixed point
<span class="math notranslate nohighlight">\( I^* =  N - \gamma/\beta \)</span> by substituting its value into the
derivative, to obtain <span class="math notranslate nohighlight">\(f'(N - \gamma/\beta) = \gamma  - \beta N  \)</span>. By
the same logic, as above, this fixed point is stable if
<span class="math notranslate nohighlight">\( \gamma  - \beta N  &lt; 0 \)</span>, or if <span class="math notranslate nohighlight">\(\gamma &lt; \beta N\)</span>. This is a
complementary condition for the fixed point at 0, that is, only one
fixed point can be stable for any given parameter values. In the
biological interpretation, if the transmission rate <span class="math notranslate nohighlight">\(\beta N\)</span> is greater
than the recovery rate <span class="math notranslate nohighlight">\(\gamma\)</span>, then the epidemic will persist.</p>
<div class="section" id="graphical-analysis-of-the-sis-model">
<h3>graphical analysis of the SIS model<a class="headerlink" href="#graphical-analysis-of-the-sis-model" title="Permalink to this headline">Â¶</a></h3>
<p>We can use our graphical analysis skills to illustrate the situation.
Consider a situation in which <span class="math notranslate nohighlight">\(\gamma &lt; \beta N\)</span>. As predicted by
stability analysis, the zero infection equilibrium should be unstable,
and the equilibrium at <span class="math notranslate nohighlight">\(N - \gamma/\beta\)</span> should be stable. In order to
plot the function <span class="math notranslate nohighlight">\(f(I) =  \beta I (N - I) - \gamma I \)</span>, we choose the
specific parameter values <span class="math notranslate nohighlight">\(N=1000\)</span>, <span class="math notranslate nohighlight">\(\gamma = 10\)</span> and <span class="math notranslate nohighlight">\(\beta = 0.1\)</span>. The
results are shown in figure a. The direction of
the flow on the <span class="math notranslate nohighlight">\(I\)</span>-axis prescribed by the function <span class="math notranslate nohighlight">\(f(I)\)</span> is shown with
red arrows. It is clear that solutions approach the fixed point at
<span class="math notranslate nohighlight">\(N - \gamma/\beta\)</span> from both directions, which make it a stable fixed
point, while diverging from <span class="math notranslate nohighlight">\(I=0\)</span>.</p>
<p>On the other hand, if <span class="math notranslate nohighlight">\(\gamma &gt; \beta N\)</span>, stability analysis predicts
that the no-infection equilibrium (<span class="math notranslate nohighlight">\(I=0\)</span>) is stable. Figure
b shows the plot of the defining function for the
parameter values <span class="math notranslate nohighlight">\(N=1000\)</span>, <span class="math notranslate nohighlight">\(\gamma = 100\)</span> and <span class="math notranslate nohighlight">\(\beta = 0.05\)</span>. The flow
on the <span class="math notranslate nohighlight">\(I\)</span>-axis is toward the zero equilibrium, therefore it is stable.
Note that the second equilibrium at <span class="math notranslate nohighlight">\( I^* =  N - \gamma/\beta \)</span> is
negative, and thus has no biological significance.</p>
<p><img alt="Graphical analysis of the SIS model with two sets of parameter values,for a population of 1000 individuals. The plots show the graph of thedefining function of the variable  (blue) and the flow on the-axis (red.) a)  leads to a persistent infectionlevel of 900. b)  implies that the only stableinfection level is zero.[]{data-label=&quot;fig:sis_graphical&quot;}" src="_images/sis_stable.png" />{width=â3inâ}
<img alt="Graphical analysis of the SIS model with two sets of parameter values,for a population of 1000 individuals. The plots show the graph of thedefining function of the variable  (blue) and the flow on the-axis (red.) a)  leads to a persistent infectionlevel of 900. b)  implies that the only stableinfection level is zero.[]{data-label=&quot;fig:sis_graphical&quot;}" src="_images/sis_unstable.png" />{width=â3inâ}</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Dmitry Kondrashov<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>