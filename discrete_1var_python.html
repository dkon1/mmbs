

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>1.3. Plotting in Python &#8212; Mathematical Methods for Biology</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-dropdown.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2. Nonlinear discrete-time dynamic models" href="discrete_nonlinear_intro.html" />
    <link rel="prev" title="1.1. Building dynamic models" href="discrete_1var_math.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Mathematical Methods for Biology</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="reference internal" href="discrete_1var_intro.html">
   1. Models with one variable in discrete time
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="discrete_1var_math.html">
     1.1. Building dynamic models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="discrete_1var_math.html#solutions-of-linear-difference-models">
     1.2. Solutions of linear difference models
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     1.3. Plotting in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#numeric-solutions-of-discrete-models">
     1.4. Numeric solutions of discrete models
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="discrete_nonlinear_intro.html">
   2. Nonlinear discrete-time dynamic models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ode_1var_intro.html">
   3. Models with one variable in continuous time
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="graph_ode_intro.html">
   4. Graphical analysis of ordinary differential equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="discrete_higher_intro.html">
   5. Discrete models of higher order
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_pp_intro.html">
   6. Linear ODEs with two variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="forces_pot_intro.html">
   7. Forces and potentials in biological modeling
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/discrete_1var_python.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/discrete_1var_python.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/executablebooks/jupyter-book/blob/master/discrete_1var_python.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#arrays-and-basic-plotting">
   1.3.1. arrays and basic plotting
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="plotting-in-python">
<h1><span class="section-number">1.3. </span>Plotting in Python<a class="headerlink" href="#plotting-in-python" title="Permalink to this headline">¶</a></h1>
<p>You can find an introduction to the plotting library matplotlib here: <a class="reference external" href="https://matplotlib.org/tutorials/introductory/pyplot.html">https://matplotlib.org/tutorials/introductory/pyplot.html</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import packages</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1"># package for work with arrays and matrices</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># package with plotting capabilities</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="arrays-and-basic-plotting">
<h2><span class="section-number">1.3.1. </span>arrays and basic plotting<a class="headerlink" href="#arrays-and-basic-plotting" title="Permalink to this headline">¶</a></h2>
<p>Here is an example of performing calculations with arrays (vectors) of values and plotting the results:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span> <span class="c1"># create an array of numbers between 0 and 10 with step 0.1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="c1"># do calculations on all the array values, call it y</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="c1"># plot x vs y</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(100,)
</pre></div>
</div>
<img alt="_images/discrete_1var_python_3_1.png" src="_images/discrete_1var_python_3_1.png" />
</div>
</div>
<p>A two dimensional array (matrix) can be defined as follows, and the function np.shape prints out the number of rows and columns in the matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2, 3)
[[1 2 3]
 [4 5 6]]
</pre></div>
</div>
</div>
</div>
<p>Strings to make text for plots
An example of concatenating a text string together with a numeric variable, which can then be used for labels or legends in plots:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">string1</span> <span class="o">=</span> <span class="s1">&#39;The value of prob is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">string1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The value of prob is 0.5
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="numeric-solutions-of-discrete-models">
<h1><span class="section-number">1.4. </span>Numeric solutions of discrete models<a class="headerlink" href="#numeric-solutions-of-discrete-models" title="Permalink to this headline">¶</a></h1>
<p>Difference equations, as we saw above, can be written in the form of <span class="math notranslate nohighlight">\(x_{t+1} = f(x_t)\)</span>. At every step, the model takes the current value of the dependent variable <span class="math notranslate nohighlight">\(x_t\)</span>, feeds it into the function <span class="math notranslate nohighlight">\(f(x)\)</span>, and takes the output as the next value <span class="math notranslate nohighlight">\(x_{t+1}\)</span>. The same process repeats every iteration, which is why difference equations written in this form are called <em>iterated maps</em>.</p>
<p>Computers are naturally suited for precise, repetitive operations. In our first example of a computational algorithm, we will iterate a given function to produce a sequence of values of the dependent variable <span class="math notranslate nohighlight">\(x\)</span>. We only need two things: to specify a computer function <span class="math notranslate nohighlight">\(f(x)\)</span>, which returns the value of the iterated map for any input value <span class="math notranslate nohighlight">\(x\)</span>, and the initial value <span class="math notranslate nohighlight">\(x_0\)</span>. Then it is a matter of repeating the operation of evaluating <span class="math notranslate nohighlight">\(f(x_t)\)</span> and storing it as the next value <span class="math notranslate nohighlight">\(x_{t+1}\)</span>. Below is the pseudocode for the algorithm. Note that I will use arrows to indicated variable assignment, square brackets <span class="math notranslate nohighlight">\([]\)</span> for indexing of
vector, and start indexing at 0, consistent with python convention.</p>
<div class="tip admonition">
<p class="admonition-title">Iterative solution of difference equations</p>
<ul class="simple">
<li><p>define the iterated map function <span class="math notranslate nohighlight">\(F(x)\)</span></p></li>
<li><p>set <span class="math notranslate nohighlight">\(N\)</span> to be the number of iterations (time steps)</p></li>
<li><p>set the initial condition <span class="math notranslate nohighlight">\(x_0\)</span></p></li>
<li><p>initialize array <span class="math notranslate nohighlight">\(x\)</span> with initial value <span class="math notranslate nohighlight">\(x_0\)</span></p></li>
<li><p>for <span class="math notranslate nohighlight">\(i\)</span> from 0 to <span class="math notranslate nohighlight">\(N-1\)</span></p>
<ul>
<li><p><span class="math notranslate nohighlight">\(x[i+1] \gets F(x[i])\)</span></p></li>
</ul>
</li>
</ul>
</div>
<p>The resulting sequence of values <span class="math notranslate nohighlight">\(x_0, x_1, x_2, ... , x_N\)</span> is called a <em>numeric solution</em> of the given difference equation. It has two disadvantages compared to an analytic solution: first, the solution can only be obtained for a specific initial value and number of iterations, and second, any computer simulation inevitably introduces some errors, for instance from round-off. In practice, however, most complex dynamical systems have to solved numerically, as analytical solutions are difficult or impossible to find.</p>
<div class="section" id="using-for-loops-for-iterative-solutions-of-dynamic-models">
<h2><span class="section-number">1.4.1. </span>using for loops for iterative solutions of dynamic models<a class="headerlink" href="#using-for-loops-for-iterative-solutions-of-dynamic-models" title="Permalink to this headline">¶</a></h2>
<p>Here is a generic linear demographic model</p>
<div class="math notranslate nohighlight">
\[ 
x(t+1) = x(t) + bx(t) - dx(t) = rx(t)
\]</div>
<p>Example of a script for producing a numeric solution of a discrete time dynamic model:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numsteps</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1"># number of iterations</span>
<span class="n">birth</span> <span class="o">=</span> <span class="mf">0.8</span> <span class="c1"># birth rate</span>
<span class="n">death</span> <span class="o">=</span>  <span class="mf">0.5</span> <span class="c1"># death rate</span>
<span class="n">pop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">numsteps</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># initialize solution array</span>
<span class="n">pop</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># initial value </span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">numsteps</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># initialze time vector</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numsteps</span><span class="p">):</span>
     <span class="n">pop</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pop</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">birth</span><span class="o">*</span><span class="n">pop</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">death</span><span class="o">*</span><span class="n">pop</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="c1"># linear demographic model</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">pop</span><span class="p">)</span> <span class="c1"># plot solution</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;population&#39;</span><span class="p">)</span>
<span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Solution with birth rate &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">birth</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; and death rate &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">death</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20]
</pre></div>
</div>
<img alt="_images/discrete_1var_python_9_1.png" src="_images/discrete_1var_python_9_1.png" />
</div>
</div>
</div>
<div class="section" id="plotting-multiple-curves-with-a-legend">
<h2><span class="section-number">1.4.2. </span>Plotting multiple curves with a legend<a class="headerlink" href="#plotting-multiple-curves-with-a-legend" title="Permalink to this headline">¶</a></h2>
<p>Multiple solution plots can be overlayed on the same figure, as long as the plt.show() is only used once in the end. For multiple graphs it’s best to use multiple colors and a legend to label different curves, using the option label in the plt.plot function and adding the function plt.legend() before producing the figure. Here’s an example with solutions of the demographic model with different death rates:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numsteps</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1"># number of iterations</span>
<span class="n">birth</span> <span class="o">=</span> <span class="mf">0.8</span> <span class="c1"># birth rate</span>
<span class="n">death</span> <span class="o">=</span>  <span class="mf">0.5</span> <span class="c1"># death rate</span>
<span class="n">pop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">numsteps</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># initialize solution array</span>
<span class="n">pop</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># initial value </span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">numsteps</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># initialze time vector</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numsteps</span><span class="p">):</span>
     <span class="n">pop</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pop</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">birth</span><span class="o">*</span><span class="n">pop</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">death</span><span class="o">*</span><span class="n">pop</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="c1"># linear demographic model</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;d = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">death</span><span class="p">))</span> <span class="c1"># plot solution</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;population&#39;</span><span class="p">)</span>

<span class="n">death</span> <span class="o">=</span>  <span class="mf">0.6</span> <span class="c1"># death rate</span>
<span class="n">pop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">numsteps</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># initialize solution array</span>
<span class="n">pop</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># initial value </span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">numsteps</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># initialze time vector</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numsteps</span><span class="p">):</span>
     <span class="n">pop</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pop</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">birth</span><span class="o">*</span><span class="n">pop</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">death</span><span class="o">*</span><span class="n">pop</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="c1"># linear demographic model</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;d = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">death</span><span class="p">))</span> <span class="c1"># plot solution</span>

<span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Population with varying death rates&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/discrete_1var_python_11_0.png" src="_images/discrete_1var_python_11_0.png" />
</div>
</div>
</div>
<div class="section" id="random-number-generators">
<h2><span class="section-number">1.4.3. </span>Random number generators<a class="headerlink" href="#random-number-generators" title="Permalink to this headline">¶</a></h2>
<p>Numpy provides a varietry of random number generators, and we’ll use these functions in the course for many purposes. Here is an example of producing arrays of random normally distributed numbers. The function requires inputs of the mean, the standard deviation, and the number of random values (or size of the array):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">num</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">norm_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">norm_sample</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The mean of the sample is &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">norm_sample</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The standard deviation of the sample is &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">norm_sample</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4.74116744 4.98997577 5.61591257 5.42631954 5.16990883 5.94050916
 4.72760834 3.94068673 4.55731371 5.80349898 3.99871793 4.89095154
 5.06568295 4.49938642 4.98608933 5.11945588 4.83496892 5.43248936
 4.62961589 4.07321333 5.03874663 4.54734694 5.23835203 5.4104576
 4.79349808 4.83567593 5.29027454 4.67918118 4.72419839 4.18519661]
The mean of the sample is 4.906213352312716
The standard deviation of the sample is 0.49120247801421424
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="discrete_1var_math.html" title="previous page"><span class="section-number">1.1. </span>Building dynamic models</a>
    <a class='right-next' id="next-link" href="discrete_nonlinear_intro.html" title="next page"><span class="section-number">2. </span>Nonlinear discrete-time dynamic models</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Dmitry Kondrashov<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>